<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Prácticas de Simulación</title>
  <meta name="description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Prácticas de Simulación" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Prácticas de Simulación" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén F. Casal (ruben.fcasal@udc.es)">


<meta name="date" content="2017-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="integracion-y-optimizacion-montecarlo.html">
<link rel="next" href="simulacion-de-variables-discretas.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Prácticas de Simulación</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#introduccion"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#ventajas-de-la-simulacion-shannon-1975"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas de la simulación (Shannon, 1975):</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes-de-la-simulacion"><i class="fa fa-check"></i><b>1.1.2</b> Inconvenientes de la simulación:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-aleatorios-puros"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios-mediante-software"><i class="fa fa-check"></i><b>1.4.1</b> Generación de números pseudoaleatorios mediante software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#opciones"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generadores-congruenciales"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generador-congruencial-lineal-simple"><i class="fa fa-check"></i><b>3.1.1</b> Generador congruencial lineal (simple)</a></li>
<li class="chapter" data-level="3.1.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#periodo"><i class="fa fa-check"></i><b>3.1.2</b> Periodo</a></li>
<li class="chapter" data-level="3.1.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.3</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#analisis-de-la-calidad-de-un-generador"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#repeticion-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#baterias-de-contrastes"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#ejercicios-de-fin-de-practica"><i class="fa fa-check"></i><b>3.3</b> Ejercicios de fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html"><i class="fa fa-check"></i><b>4</b> Análisis de los resultados</a><ul>
<li class="chapter" data-level="4.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#convergencia"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a></li>
<li class="chapter" data-level="4.2" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#estimacion-de-la-precision"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#teorema-central-del-limite"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#determinacion-del-numero-de-generaciones"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#el-problema-de-la-dependencia"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia:</a><ul>
<li class="chapter" data-level="4.5.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#observaciones"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><i class="fa fa-check"></i><b>5</b> Aplicaciones de la simulación en Inferencia Estadística</a><ul>
<li class="chapter" data-level="5.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#aplicaciones-de-la-simulacion"><i class="fa fa-check"></i><b>5.1</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="5.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#distribucion-en-el-muestreo"><i class="fa fa-check"></i><b>5.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="5.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>5.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="5.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#contrastes-de-hipotesis"><i class="fa fa-check"></i><b>5.4</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="5.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#comparacion-de-estimadores"><i class="fa fa-check"></i><b>5.5</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="5.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="5.6.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#idea"><i class="fa fa-check"></i><b>5.6.1</b> Idea:</a></li>
<li class="chapter" data-level="5.6.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#metodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="5.6.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#ejemplo"><i class="fa fa-check"></i><b>5.6.3</b> Ejemplo</a></li>
<li class="chapter" data-level="5.6.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>5.6.4</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="5.6.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#graficos"><i class="fa fa-check"></i><b>5.6.5</b> Gráficos</a></li>
<li class="chapter" data-level="5.6.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>5.6.6</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html"><i class="fa fa-check"></i><b>6</b> Integración y Optimización Montecarlo</a><ul>
<li class="chapter" data-level="6.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#integracion-monte-carlo-clasica"><i class="fa fa-check"></i><b>6.1</b> Integración Monte Carlo (clásica)</a></li>
<li class="chapter" data-level="6.2" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="6.2.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#optimizacion-monte-carlo"><i class="fa fa-check"></i><b>6.3</b> Optimización Monte Carlo</a></li>
<li class="chapter" data-level="6.4" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#temple-simulado"><i class="fa fa-check"></i><b>6.4</b> Temple simulado</a></li>
<li class="chapter" data-level="6.5" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#algoritmos-geneticos"><i class="fa fa-check"></i><b>6.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html"><i class="fa fa-check"></i><b>7</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="7.1" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-inversion"><i class="fa fa-check"></i><b>7.1</b> Método de inversión</a></li>
<li class="chapter" data-level="7.2" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-aceptacion-rechazo"><i class="fa fa-check"></i><b>7.2</b> Método de aceptación-rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#ejercicios-1"><i class="fa fa-check"></i><b>7.3</b> Ejercicios</a></li>
<li class="chapter" data-level="7.4" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodos-especificos-para-generacion-de-distribuciones-notables"><i class="fa fa-check"></i><b>7.4</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html"><i class="fa fa-check"></i><b>8</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="8.1" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#ejercicios-2"><i class="fa fa-check"></i><b>8.1</b> Ejercicios</a></li>
<li class="chapter" data-level="8.2" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#metodos-especificos-para-generacion-de-distribuciones-notables-1"><i class="fa fa-check"></i><b>8.2</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html"><i class="fa fa-check"></i><b>9</b> Simulación de Distribuciones Multidimensionales</a><ul>
<li class="chapter" data-level="9.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#introduccion-1"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#factorizacion-de-la-matriz-de-covarianzas"><i class="fa fa-check"></i><b>9.2</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="9.3" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-condicional-e-incondicional"><i class="fa fa-check"></i><b>9.3</b> Simulación condicional e incondicional</a></li>
<li class="chapter" data-level="9.4" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-basada-en-copulas"><i class="fa fa-check"></i><b>9.4</b> Simulación basada en cópulas</a></li>
<li class="chapter" data-level="9.5" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-distribuciones-multidimensionales-discretas"><i class="fa fa-check"></i><b>9.5</b> Simulación de distribuciones multidimensionales discretas</a><ul>
<li class="chapter" data-level="9.5.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>9.5.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="9.5.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-tablas-de-contingencia"><i class="fa fa-check"></i><b>9.5.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#reduccion-de-la-varianza"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-antiteticas"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejemplo-integracion-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#generacion-de-variables-antiteticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#estratificacion"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-de-control"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#numeros-aleatorios-comunes"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejercicios-fin-de-practica"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pendiente-ejercicios-bookdown.html"><a href="pendiente-ejercicios-bookdown.html"><i class="fa fa-check"></i><b>11</b> Pendiente (ejercicios bookdown)</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-basica"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-complementaria"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html"><i class="fa fa-check"></i><b>A</b> Recursos para el aprendizaje de R</a><ul>
<li class="chapter" data-level="A.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#cursos"><i class="fa fa-check"></i><b>A.1</b> Cursos</a></li>
<li class="chapter" data-level="A.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#libros"><i class="fa fa-check"></i><b>A.2</b> Libros</a><ul>
<li class="chapter" data-level="A.2.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#iniciacion"><i class="fa fa-check"></i><b>A.2.1</b> Iniciación</a></li>
<li class="chapter" data-level="A.2.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#avanzados"><i class="fa fa-check"></i><b>A.2.2</b> Avanzados</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#material"><i class="fa fa-check"></i><b>A.3</b> Material</a></li>
<li class="chapter" data-level="A.4" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#ayuda"><i class="fa fa-check"></i><b>A.4</b> Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="integracion-numerica.html"><a href="integracion-numerica.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a><ul>
<li class="chapter" data-level="B.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#introduccion-2"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-unidimensional"><i class="fa fa-check"></i><b>B.2</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="B.2.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide"><i class="fa fa-check"></i><b>B.2.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.2.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.2.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.2.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.2.4" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-de-r"><i class="fa fa-check"></i><b>B.2.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-bidimensional"><i class="fa fa-check"></i><b>B.3</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="B.3.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#representacion-grafica"><i class="fa fa-check"></i><b>B.3.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.3.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide-1"><i class="fa fa-check"></i><b>B.3.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.3.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-r"><i class="fa fa-check"></i><b>B.3.3</b> Comandos R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Simulación</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulacion-de-variables-continuas" class="section level1">
<h1><span class="header-section-number">Capítulo 7</span> Simulación de variables continuas</h1>
<p><strong><em>Pendiente: ejemplos y teoría</em></strong></p>
<div id="metodo-de-inversion" class="section level2">
<h2><span class="header-section-number">7.1</span> Método de inversión</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-1" class="exercise"><strong>Ejercicio 5.1  </strong></span>
</div>
<p> La distribución doble exponencial (o distribución de Laplace) de parámetro <span class="math inline">\(\lambda\)</span> tiene función de densidad: <span class="math display">\[f\left(  x\right)  =\frac{\lambda}{2}e^{-\lambda\left\vert x\right\vert
}\text{, }x\in\mathbb{R}\]</span> y función de distribución: <span class="math display">\[F\left(  x\right)  =\int_{-\infty}^{x}f\left(  t\right)  dt=\left\{
\begin{array}{ll}
\frac{1}{2}e^{\lambda x} &amp; x&lt;0\\
1-\frac{1}{2}e^{-\lambda x} &amp; x\geq0
\end{array}
\ \right.\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Escribir una función que permita generar, por el método de inversión, una muestra de <span class="math inline">\(n\)</span> observaciones de esta distribución (NOTA: esta distribución puede generarse fácilmente simulando una distribución exponencial y otorgarle un signo positivo o negativo con equiprobabilidad; ver método de composición).</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ddexp &lt;-<span class="st"> </span>function(x, <span class="dt">lambda =</span> <span class="dv">1</span>){
<span class="co"># Densidad doble exponencial</span>
  lambda*<span class="kw">exp</span>(-lambda*<span class="kw">abs</span>(x))/<span class="dv">2</span>
}

rdexp &lt;-<span class="st"> </span>function(<span class="dt">lambda =</span> <span class="dv">1</span>){
<span class="co"># Simulación por inversión</span>
<span class="co"># Doble exponencial</span>
  U &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
  if (U&lt;<span class="fl">0.5</span>) {
    <span class="kw">return</span>(<span class="kw">log</span>(<span class="dv">2</span>*U)/lambda)
  } else {
    <span class="kw">return</span>(-<span class="kw">log</span>(<span class="dv">2</span>*(<span class="dv">1</span>-U))/lambda)
  }
}

rdexpn &lt;-<span class="st"> </span>function(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">lambda =</span> <span class="dv">1</span>) {
<span class="co"># Simulación n valores de doble exponencial</span>
    x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
    for(i in <span class="dv">1</span>:n) x[i]&lt;-<span class="kw">rdexp</span>(lambda)
    <span class="kw">return</span>(x)
}</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Generar <span class="math inline">\(10^{4}\)</span> valores de la distribución doble exponencial de parámetro <span class="math inline">\(\lambda=2\)</span> y obtener el tiempo de CPU que tarda en generar la secuencia.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
<span class="kw">system.time</span>(x &lt;-<span class="st"> </span><span class="kw">rdexpn</span>(<span class="dv">10</span>^<span class="dv">4</span>, <span class="dv">2</span>))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.04    0.01    0.06</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Representar el histograma y compararlo con la densidad teórica.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x, <span class="dt">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>)
<span class="co"># lines(density(x), col = &#39;blue&#39;)</span>
<span class="kw">curve</span>(<span class="kw">ddexp</span>(x, <span class="dv">2</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="07-Continuas_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="metodo-de-aceptacion-rechazo" class="section level2">
<h2><span class="header-section-number">7.2</span> Método de aceptación-rechazo</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-5" class="exercise"><strong>Ejercicio 7.1  </strong></span>
</div>
<p> Desarrollar el código necesario para generar, por el método de aceptación-rechazo, una muestra de <span class="math inline">\(n\)</span> observaciones de una distribución normal estándar: <span class="math display">\[f\left(  x\right)  =\frac{1}{\sqrt{2\pi}}e^{-\frac{x^{2}}{2}}\text{, }x\in\mathbb{R}\text{, }\]</span> empleando como distribución auxiliar una doble exponencial. Puede verse que la elección de la densidad auxiliar óptima se corresponde con <span class="math inline">\(\lambda=1\)</span> y que la cota optima es:<span class="math display">\[c_{\text{opt}}=\sqrt{\frac{2e}{\pi}}\simeq1.\,3155.\]</span> Para esteblecer la condición de aceptación o rechazo se puede tener en cuenta que: <span class="math display">\[c\cdot U\cdot\frac{g\left(  T\right)  }{f\left(  T\right)  }=\sqrt{\frac
{2e}{\pi}}U\sqrt{\frac{\pi}{2}}\exp\left(  \frac{T^{2}}{2}-\left\vert
T\right\vert \right)  =U\cdot\exp\left(  \frac{T^{2}}{2}-\left\vert
T\right\vert +\frac{1}{2}\right)  ,\]</span> aunque en general puede ser recomendable emplear <span class="math inline">\(c\cdot U\cdot g\left( T\right) \leq f\left( T\right)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># densidad objetivo: dnorm</span>
<span class="co"># densidad auxiliar: ddexp</span>

<span class="co"># EJECUTAR CÓDIGO DEL APARTADO A DEL EJERCICIO 1</span>
c.opt &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>*<span class="kw">exp</span>(<span class="dv">1</span>)/pi)
lambda.opt &lt;-<span class="st"> </span><span class="dv">1</span>
ngen &lt;-<span class="st"> </span><span class="dv">0</span>

rnormAR &lt;-<span class="st"> </span>function() {
<span class="co"># Simulación por aceptación-rechazo</span>
<span class="co"># Normal estandar a partir de doble exponencial</span>
  while (<span class="ot">TRUE</span>) {
    U &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
    X &lt;-<span class="st"> </span><span class="kw">rdexp</span>(<span class="dv">1</span>)
    ngen &lt;&lt;-<span class="st"> </span>ngen<span class="dv">+1</span> <span class="co"># Comentar esta línea para uso normal</span>
    <span class="co"># if (U*exp((X^2+1)*0.5-abs(X)) &lt;= 1) return(X)</span>
    if (c.opt *<span class="st"> </span>U *<span class="st"> </span><span class="kw">ddexp</span>(X, lambda.opt) &lt;=<span class="st"> </span><span class="kw">dnorm</span>(X)) <span class="kw">return</span>(X)
  }
}

rnormARn &lt;-<span class="st"> </span>function(<span class="dt">n=</span><span class="dv">1000</span>) {
<span class="co"># Simulación n valores N(0,1)</span>
    x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
    for(i in <span class="dv">1</span>:n) x[i]&lt;-<span class="kw">rnormAR</span>()
    <span class="kw">return</span>(x)
}

<span class="co"># Grafico</span>
<span class="kw">curve</span>(c.opt *<span class="st"> </span><span class="kw">ddexp</span>(x), <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">4</span>, <span class="dv">4</span>), <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="07-Continuas_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<ol style="list-style-type: lower-alpha">
<li>Generar una muestra de <span class="math inline">\(10^{4}\)</span> observaciones empleando este algoritmo. Obtener el tiempo de CPU y calcular el número medio de generaciones de la distribución auxiliar.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nsim &lt;-<span class="st"> </span><span class="dv">10</span>^<span class="dv">4</span>

ngen &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">system.time</span>(x &lt;-<span class="st"> </span><span class="kw">rnormARn</span>(nsim))</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.35    0.00    0.34</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Nº generaciones</span>
{
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nº de generaciones = &quot;</span>, ngen)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nº medio de generaciones = &quot;</span>, ngen/nsim)
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span>-nsim/ngen, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## 
## Nº de generaciones =  13163
## Nº medio de generaciones =  1.3163
## Proporción de rechazos =  0.2402948</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Representar el histograma y compararlo con la densidad teórica.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="st">&quot;FD&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x), <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="07-Continuas_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Aproximar la cota óptima numéricamente.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtención de un valor c óptimo aproximado</span>
<span class="kw">optimize</span>(<span class="dt">f=</span>function(x){<span class="kw">dnorm</span>(x)/<span class="kw">ddexp</span>(x)}, <span class="dt">maximum=</span><span class="ot">TRUE</span>, <span class="dt">interval=</span><span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<pre><code>## $maximum
## [1] -0.999959
## 
## $objective
## [1] 1.315489</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># NOTA: Cuidado con los límites</span>
<span class="co"># optimize(f=function(x){dnorm(x)/ddexp(x)}, maximum=TRUE, interval=c(0,2))</span>

<span class="co"># Valor óptimo real</span>
<span class="co"># sqrt(2*exp(1)/pi)</span>
c.opt</code></pre></div>
<pre><code>## [1] 1.315489</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Aproximar el parámetro óptimo de la densidad auxiliar numéricamente (normalmente comenzaríamos por este paso).</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtención de valores c y lambda óptimos aproximados</span>
fopt &lt;-<span class="st"> </span>function(lambda) {
  <span class="co"># Obtiene c fijado lambda</span>
  <span class="kw">optimize</span>(<span class="dt">f =</span> function(x){<span class="kw">dnorm</span>(x)/<span class="kw">ddexp</span>(x,lambda)},
           <span class="dt">maximum=</span><span class="ot">TRUE</span>, <span class="dt">interval=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))$objective
}

<span class="co"># Encontar lambda que minimiza</span>
res &lt;-<span class="st"> </span><span class="kw">optimize</span>(<span class="dt">f=</span>function(x){<span class="kw">fopt</span>(x)}, <span class="dt">interval=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">2</span>))
lambda.opt2 &lt;-<span class="st"> </span>res$minimum
c.opt2 &lt;-<span class="st"> </span>res$objective</code></pre></div>

<div class="exercise">
<span id="exr:unnamed-chunk-11" class="exercise"><strong>Ejercicio 7.2  </strong></span>
</div>
<p> Para la estimación Bayes de la media de una normal se suele utilizar como distribución a priori una Cauchy.</p>
<ol style="list-style-type: lower-alpha">
<li>Generar una muestra i.i.d. <span class="math inline">\(X_{i}\sim N(\theta_{0},1)\)</span> de tamaño <span class="math inline">\(n=10\)</span> con <span class="math inline">\(\theta_{0}=1\)</span>. Utilizar una <span class="math inline">\(Cauchy(0,1)\)</span> (<code>rcauchy</code>) como distribución a priori y como densidad auxiliar para simular por aceptación-rechazo una muestra de la densidad a posteriori (emplear <code>dnorm</code> para construir la verosimilitud). Obtener el intervalo de probabilidad al 95%.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu0 &lt;-<span class="st"> </span><span class="dv">1</span>
n &lt;-<span class="st"> </span><span class="dv">10</span>
nsim &lt;-<span class="st"> </span><span class="dv">10</span>^<span class="dv">3</span>
<span class="kw">set.seed</span>(<span class="dv">54321</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> mu0)

<span class="co"># Función de verosimilitud</span>
lik &lt;-<span class="st"> </span>function(mu){<span class="kw">prod</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mu))}

<span class="co"># Cota óptima</span>
<span class="co"># Estimación por máxima verosimilitud</span>
emv &lt;-<span class="st"> </span><span class="kw">optimize</span>(<span class="dt">f =</span> lik, <span class="dt">int =</span> <span class="kw">range</span>(x), <span class="dt">maximum =</span> <span class="ot">TRUE</span>)
emv</code></pre></div>
<pre><code>## $maximum
## [1] 0.7353805
## 
## $objective
## [1] 3.303574e-08</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c &lt;-<span class="st"> </span>emv$objective

<span class="kw">mean</span>(x)</code></pre></div>
<pre><code>## [1] 0.7353958</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c &lt;-<span class="st"> </span><span class="kw">lik</span>(<span class="kw">mean</span>(x))
c</code></pre></div>
<pre><code>## [1] 3.303574e-08</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulación distribución a posteriori</span>
<span class="co"># Simulación por aceptación-rechazo a partir de Cauchy(0,1)</span>
ngen &lt;-<span class="st"> </span>nsim
Y &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(nsim)
ind &lt;-<span class="st"> </span>(c*<span class="kw">runif</span>(nsim) &gt;<span class="st"> </span><span class="kw">sapply</span>(Y, lik)) <span class="co"># TRUE si no verifica condición</span>
<span class="co"># Volver a generar si no verifica condición</span>
while (<span class="kw">sum</span>(ind)&gt;<span class="dv">0</span>){
  le &lt;-<span class="st"> </span><span class="kw">sum</span>(ind)
  ngen &lt;-<span class="st"> </span>ngen +<span class="st"> </span>le
  Y[ind] &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(le)
  ind[ind] &lt;-<span class="st"> </span>(c*<span class="kw">runif</span>(le) &gt;<span class="st"> </span><span class="kw">sapply</span>(Y[ind], lik)) <span class="co"># TRUE si no verifica condición</span>
}


{ <span class="co"># Nº generaciones</span>
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nº de generaciones = &quot;</span>, ngen)
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nº medio de generaciones = &quot;</span>, ngen/nsim)
  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos = &quot;</span>, <span class="dv">1</span>-nsim/ngen,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)
}</code></pre></div>
<pre><code>## 
## Nº de generaciones =  5898
## Nº medio de generaciones =  5.898
## Proporción de rechazos =  0.830451</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Intervalo de probabilidad al 95% (IC Bayes)</span>
q &lt;-<span class="st"> </span><span class="kw">quantile</span>(Y, <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))

<span class="co"># Representar estimador e IC Bayes</span>
<span class="kw">hist</span>(Y, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">&quot;Distribución a posteriori&quot;</span>)
<span class="co"># abline(v = mean(x), lty = 3) # Estimación frecuentista</span>
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">mean</span>(Y), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)  <span class="co"># Estimación Bayesiana</span>
<span class="kw">abline</span>(<span class="dt">v =</span> q, <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="07-Continuas_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Repetir el apartado anterior con <span class="math inline">\(n=100\)</span>.</li>
</ol>
</div>
<div id="ejercicios-1" class="section level2">
<h2><span class="header-section-number">7.3</span> Ejercicios</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-13" class="exercise"><strong>Ejercicio 7.3  </strong></span>para entregar
</div>
<p> Escribir el código necesario para generar, por el método de inversión, una muestra de <span class="math inline">\(n\)</span> observaciones de una distribución de Cauchy.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generar una muestra de <span class="math inline">\(10^{4}\)</span> observaciones y obtener el tiempo de CPU.</p></li>
<li><p>Representar el histograma (limitar el rango, e.g. <code>xlim = c(-10, 10)</code>) y compararlo con la densidad teórica (<code>dcauchy</code>).</p></li>
<li><p>Obtener conclusiones sobre la existencia de una media teórica a partir de la media muestral aproximada por simulación (estudiar la convergencia de la media muestral). Suponiendo que el vector <code>x</code> contiene las simulaciones, estudiar la convergencia de la media muestral mediante el gráfico:<code>plot(1:nsim, cumsum(x)/(1:nsim), type=&quot;l&quot;, ylab=&quot;Media muestral&quot;, xlab=&quot;Nº de simulaciones&quot;)</code></p></li>
</ol>

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>Ejercicio 2.4  </strong></span>para entregar
</div>
<p> El tiempo de respuesta (en centésimas de segundo) de un servidor de bases de datos es una variable con función de densidad:<span class="math display">\[f(x)=xe^{-x}\text{ si }x\geq0.\]</span> Escribir el código necesario para generar, por el método de aceptación-rechazo, una muestra de <span class="math inline">\(n\)</span> observaciones de esta distribución empleando como densidad auxiliar una exponencial:<span class="math display">\[g(x)=\lambda e^{-\lambda x}\text{ si }x\geq0.\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Aproximar numéricamente el parámetro óptimo (<span class="math inline">\(\lambda_{opt}&lt;1\)</span>) y la cota óptima (<span class="math inline">\(c_{opt}\)</span>) de la densidad auxiliar y compararlos con los valores teóricos: <span class="math inline">\(\lambda_{opt}=1/2\)</span> y <span class="math inline">\(c_{opt}=4/e\)</span>.</p></li>
<li><p>Generar una muestra de 1000 observaciones de la distribución de interés (tomando como semilla inicial el nº de grupo multiplicado por 100). Obtener el tiempo de CPU que tarda en generar la secuencia y calcular el número medio de generaciones de la distribución auxiliar.</p></li>
<li><p>Representar el histograma y compararlo con la densidad teórica.</p></li>
</ol>
</div>
<div id="metodos-especificos-para-generacion-de-distribuciones-notables" class="section level2">
<h2><span class="header-section-number">7.4</span> Métodos específicos para generación de distribuciones notables</h2>
<p><strong><em>Pendiente: algunos ejemplos del libro de Ricardo y de las funciones implementadas en R</em></strong></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="integracion-y-optimizacion-montecarlo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulacion-de-variables-discretas.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-Continuas.Rmd",
"text": "Edit"
},
"download": ["Practicas_de_Simulacion.pdf", "Practicas_de_Simulacion.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
