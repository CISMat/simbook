<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Prácticas de Simulación</title>
  <meta name="description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Prácticas de Simulación" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Prácticas de Simulación" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén F. Casal (ruben.fcasal@udc.es)">


<meta name="date" content="2017-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="simulacion-de-distribuciones-multidimensionales.html">
<link rel="next" href="pendiente-ejercicios-bookdown.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Prácticas de Simulación</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#introduccion"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#ventajas-de-la-simulacion-shannon-1975"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas de la simulación (Shannon, 1975):</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes-de-la-simulacion"><i class="fa fa-check"></i><b>1.1.2</b> Inconvenientes de la simulación:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-aleatorios-puros"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios-mediante-software"><i class="fa fa-check"></i><b>1.4.1</b> Generación de números pseudoaleatorios mediante software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#opciones"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generadores-congruenciales"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generador-congruencial-lineal-simple"><i class="fa fa-check"></i><b>3.1.1</b> Generador congruencial lineal (simple)</a></li>
<li class="chapter" data-level="3.1.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#periodo"><i class="fa fa-check"></i><b>3.1.2</b> Periodo</a></li>
<li class="chapter" data-level="3.1.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.3</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#analisis-de-la-calidad-de-un-generador"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#repeticion-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#baterias-de-contrastes"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#ejercicios-de-fin-de-practica"><i class="fa fa-check"></i><b>3.3</b> Ejercicios de fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html"><i class="fa fa-check"></i><b>4</b> Análisis de los resultados</a><ul>
<li class="chapter" data-level="4.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#convergencia"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a></li>
<li class="chapter" data-level="4.2" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#estimacion-de-la-precision"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#teorema-central-del-limite"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#determinacion-del-numero-de-generaciones"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#el-problema-de-la-dependencia"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia:</a><ul>
<li class="chapter" data-level="4.5.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#observaciones"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><i class="fa fa-check"></i><b>5</b> Aplicaciones de la simulación en Inferencia Estadística</a><ul>
<li class="chapter" data-level="5.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#aplicaciones-de-la-simulacion"><i class="fa fa-check"></i><b>5.1</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="5.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#distribucion-en-el-muestreo"><i class="fa fa-check"></i><b>5.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="5.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>5.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="5.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#contrastes-de-hipotesis"><i class="fa fa-check"></i><b>5.4</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="5.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#comparacion-de-estimadores"><i class="fa fa-check"></i><b>5.5</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="5.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="5.6.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#idea"><i class="fa fa-check"></i><b>5.6.1</b> Idea:</a></li>
<li class="chapter" data-level="5.6.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#metodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="5.6.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#ejemplo"><i class="fa fa-check"></i><b>5.6.3</b> Ejemplo</a></li>
<li class="chapter" data-level="5.6.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>5.6.4</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="5.6.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#graficos"><i class="fa fa-check"></i><b>5.6.5</b> Gráficos</a></li>
<li class="chapter" data-level="5.6.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>5.6.6</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html"><i class="fa fa-check"></i><b>6</b> Integración y Optimización Montecarlo</a><ul>
<li class="chapter" data-level="6.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#integracion-monte-carlo-clasica"><i class="fa fa-check"></i><b>6.1</b> Integración Monte Carlo (clásica)</a></li>
<li class="chapter" data-level="6.2" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="6.2.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#optimizacion-monte-carlo"><i class="fa fa-check"></i><b>6.3</b> Optimización Monte Carlo</a></li>
<li class="chapter" data-level="6.4" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#temple-simulado"><i class="fa fa-check"></i><b>6.4</b> Temple simulado</a></li>
<li class="chapter" data-level="6.5" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#algoritmos-geneticos"><i class="fa fa-check"></i><b>6.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html"><i class="fa fa-check"></i><b>7</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="7.1" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-inversion"><i class="fa fa-check"></i><b>7.1</b> Método de inversión</a></li>
<li class="chapter" data-level="7.2" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-aceptacion-rechazo"><i class="fa fa-check"></i><b>7.2</b> Método de aceptación-rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#ejercicios-1"><i class="fa fa-check"></i><b>7.3</b> Ejercicios</a></li>
<li class="chapter" data-level="7.4" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodos-especificos-para-generacion-de-distribuciones-notables"><i class="fa fa-check"></i><b>7.4</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html"><i class="fa fa-check"></i><b>8</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="8.1" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#ejercicios-2"><i class="fa fa-check"></i><b>8.1</b> Ejercicios</a></li>
<li class="chapter" data-level="8.2" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#metodos-especificos-para-generacion-de-distribuciones-notables-1"><i class="fa fa-check"></i><b>8.2</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html"><i class="fa fa-check"></i><b>9</b> Simulación de Distribuciones Multidimensionales</a><ul>
<li class="chapter" data-level="9.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#introduccion-1"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#factorizacion-de-la-matriz-de-covarianzas"><i class="fa fa-check"></i><b>9.2</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="9.3" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-condicional-e-incondicional"><i class="fa fa-check"></i><b>9.3</b> Simulación condicional e incondicional</a></li>
<li class="chapter" data-level="9.4" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-basada-en-copulas"><i class="fa fa-check"></i><b>9.4</b> Simulación basada en cópulas</a></li>
<li class="chapter" data-level="9.5" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-distribuciones-multidimensionales-discretas"><i class="fa fa-check"></i><b>9.5</b> Simulación de distribuciones multidimensionales discretas</a><ul>
<li class="chapter" data-level="9.5.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>9.5.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="9.5.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-tablas-de-contingencia"><i class="fa fa-check"></i><b>9.5.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#reduccion-de-la-varianza"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-antiteticas"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejemplo-integracion-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#generacion-de-variables-antiteticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#estratificacion"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-de-control"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#numeros-aleatorios-comunes"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejercicios-fin-de-practica"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pendiente-ejercicios-bookdown.html"><a href="pendiente-ejercicios-bookdown.html"><i class="fa fa-check"></i><b>11</b> Pendiente (ejercicios bookdown)</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-basica"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-complementaria"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html"><i class="fa fa-check"></i><b>A</b> Recursos para el aprendizaje de R</a><ul>
<li class="chapter" data-level="A.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#cursos"><i class="fa fa-check"></i><b>A.1</b> Cursos</a></li>
<li class="chapter" data-level="A.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#libros"><i class="fa fa-check"></i><b>A.2</b> Libros</a><ul>
<li class="chapter" data-level="A.2.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#iniciacion"><i class="fa fa-check"></i><b>A.2.1</b> Iniciación</a></li>
<li class="chapter" data-level="A.2.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#avanzados"><i class="fa fa-check"></i><b>A.2.2</b> Avanzados</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#material"><i class="fa fa-check"></i><b>A.3</b> Material</a></li>
<li class="chapter" data-level="A.4" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#ayuda"><i class="fa fa-check"></i><b>A.4</b> Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="integracion-numerica.html"><a href="integracion-numerica.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a><ul>
<li class="chapter" data-level="B.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#introduccion-2"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-unidimensional"><i class="fa fa-check"></i><b>B.2</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="B.2.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide"><i class="fa fa-check"></i><b>B.2.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.2.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.2.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.2.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.2.4" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-de-r"><i class="fa fa-check"></i><b>B.2.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-bidimensional"><i class="fa fa-check"></i><b>B.3</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="B.3.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#representacion-grafica"><i class="fa fa-check"></i><b>B.3.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.3.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide-1"><i class="fa fa-check"></i><b>B.3.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.3.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-r"><i class="fa fa-check"></i><b>B.3.3</b> Comandos R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Simulación</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tecnicas-de-reduccion-de-la-varianza" class="section level1">
<h1><span class="header-section-number">Capítulo 10</span> Técnicas de reducción de la varianza</h1>
<div id="reduccion-de-la-varianza" class="section level2">
<h2><span class="header-section-number">10.1</span> Reducción de la varianza</h2>
<p>Éstas técnicas son aplicadas normalmente cuando se pretende ofrecer respuestas lo más precisas posibles (con menor costo computacional) y principalmente sobre cantidades medias.</p>
<ul>
<li>Supongamos que <strong>estamos interesados en aproximar la media</strong> de un estadístico mediante simulación y <strong>no nos interesa aproximar su varianza</strong>.</li>
</ul>
<p>Existe un sinfín de técnicas encaminadas a reducir la varianza en un estudio de simulación (respecto a una aproximación estandar). Algunas de ellas son:</p>
<ul>
<li><p>Muestreo por importancia.</p></li>
<li><p>Variables antitéticas.</p></li>
<li><p>Muestreo estratificado.</p></li>
<li><p>Variables de control.</p></li>
<li><p>Números aleatorios comunes.</p></li>
<li><p>Métodos de remuestreo.</p></li>
<li><p>Condicionamiento.</p></li>
<li><p>…</p></li>
</ul>
</div>
<div id="variables-antiteticas" class="section level2">
<h2><span class="header-section-number">10.2</span> Variables antitéticas</h2>
<p>Supongamos que pretendemos aproximar <span class="math display">\[\theta=E\left(  Z\right)\]</span> con <span class="math inline">\(Var\left( Z \right) = \sigma^{2}\)</span>. Si generamos <span class="math inline">\(n\)</span> pares <span class="math inline">\(\left( X_{1},Y_{1}\right), ... ,\left( X_{n},Y_{n}\right)\)</span> de <span class="math inline">\(X\sim Y\sim Z\)</span> con <span class="math inline">\(Cov\left( X,Y\right) &lt; 0\)</span>, el estimador combinado tiene menor varianza: <span class="math display">\[\begin{aligned}
    Var\left(  \frac{\overline{X}+\overline{Y}}{2}\right)   &amp; =\frac{1}{4}\left(
    Var\left(  \overline{X}\right)  +Var\left(  \overline{Y}\right)  +2Cov\left(
    \overline{X},\overline{Y}\right)  \right) \\
    &amp; =\frac{\sigma^{2}}{2n}+\frac{1}{2n}Cov\left(  X,Y\right) \\
    &amp; =\frac{\sigma^{2}}{2n}\left(  1+\rho \left(  X,Y\right)  \right),
\end{aligned}\]</span> que el equivalente a una muestra unidimensional independiente con el mismo número de observaciones <span class="math inline">\(2n\)</span> (con una reducción del <span class="math inline">\(-100\rho \left( X,Y\right) \%\)</span>).</p>
<div id="ejemplo-integracion-monte-carlo" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Ejemplo: Integración Monte Carlo</h3>
<p>Para aproximar: <span class="math display">\[I=\int_{0}^{1}h\left(  x\right) dx,\]</span> a partir de <span class="math inline">\(x_{1},x_{2},\ldots,x_{n}\)</span> <span class="math inline">\(i.i.d.\)</span> <span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span>. Podemos emplear: <span class="math display">\[\begin{aligned}
    I  &amp; =E\left(  \frac{h\left(  U\right)  +h\left(  1-U\right)  }{2}\right) \\
    &amp; \approx \frac{1}{2n}\sum \limits_{i=1}^{n}\left(  h\left(  x_{i}\right)
    +h\left(  1-x_{i}\right)  \right).
\end{aligned}\]</span></p>
</div>
<div id="generacion-de-variables-antiteticas" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Generación de variables antitéticas</h3>
<p>Cuando se utiliza el método de inversión resulta sencillo obtener pares de variables con correlación negativa:</p>
<ul>
<li><p><span class="math inline">\(U\sim \mathcal{U}\left( 0,1\right)\)</span> para simular <span class="math inline">\(X\)</span>.</p></li>
<li><p><span class="math inline">\(1-U\)</span> para simular la variable antitética <span class="math inline">\(Y\)</span>.</p></li>
</ul>
<p>En el caso general, si <span class="math inline">\(X=h\left( U_{1},\ldots,U_{d}\right)\)</span> y <span class="math inline">\(h\)</span> es monótona puede verse (e.g. Ross, 1997) que <span class="math inline">\(Y=h\left( 1-U_{1},\ldots,1-U_{d}\right)\)</span> está negativamente correlada con <span class="math inline">\(X\)</span>.</p>
<p>Si <span class="math inline">\(X\sim \mathcal{N}(\mu,\sigma)\)</span> puede tomarse como variable antitética <span class="math display">\[Y=2\mu-X\]</span> En general esto es válido para cualquier variable simétrica repecto a un parámetro <span class="math inline">\(\mu\)</span>. (e.g. <span class="math inline">\(X\sim \mathcal{U}(a,b)\)</span> e <span class="math inline">\(Y=a+b-X\)</span>).</p>

<div class="exercise">
<span id="exr:unnamed-chunk-1" class="exercise"><strong>Ejercicio 5.1  </strong></span>Variables antitéticas en integración Monte Carlo
</div>
<p></p>
<p>Crear una función que implemente la técnica de variables antitéticas para aproximar integrales del tipo:<span class="math display">\[I=\int_{a}^{b}h\left(  x\right)  dx.\]</span> Emplearla para aproximar: <span class="math display">\[E\left(  e^{\mathcal{U}(0,2)}\right)  =\int_{0}^{2}\frac{1}{2}e^{x}dx\approx3.194,\label{integralmc}\]</span> y representar gráficamente la aproximación en función de <span class="math inline">\(n\)</span>. Función objetivo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">0</span>; b &lt;-<span class="st"> </span><span class="dv">2</span>
ftn &lt;-<span class="st"> </span>function(x) <span class="kw">return</span>(<span class="kw">exp</span>(x)/(b-a))
<span class="kw">curve</span>(ftn, a, b, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">4</span>))
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(a,b),<span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="10-Reduccion_varianza_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Se trata de calcular la media de <span class="math inline">\(e^{\mathcal{U}(0,2)}\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">teor &lt;-<span class="st"> </span>(<span class="kw">exp</span>(b)-<span class="kw">exp</span>(a))/(b-a)
teor</code></pre></div>
<pre><code>## [1] 3.194528</code></pre>
<p>Para la aproximación por integración Monte Carlo podemos emplear la función del capítulo anterior:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mc.integral &lt;-<span class="st"> </span>function(ftn, a, b, n, <span class="dt">plot=</span><span class="ot">TRUE</span>) {
  fx &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">runif</span>(n, a, b), ftn)*(b-a)
  if (plot) {
    estint &lt;-<span class="st"> </span><span class="kw">cumsum</span>(fx)/(<span class="dv">1</span>:n)
    esterr &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">cumsum</span>((fx-estint)^<span class="dv">2</span>))/(<span class="dv">1</span>:n)
    <span class="kw">plot</span>(estint, <span class="dt">ylab=</span><span class="st">&quot;Media y rango de error&quot;</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span> <span class="dv">2</span>, 
         <span class="dt">ylim=</span><span class="kw">mean</span>(fx)+<span class="dv">2</span>*<span class="kw">c</span>(-esterr[<span class="dv">1</span>],esterr[<span class="dv">1</span>]), <span class="dt">xlab=</span><span class="st">&quot;Iteraciones&quot;</span>)
    <span class="kw">abline</span>(<span class="dt">h =</span> estint[n], <span class="dt">lty=</span><span class="dv">2</span>)
    <span class="kw">lines</span>(estint<span class="dv">+2</span>*esterr, <span class="dt">lty =</span> <span class="dv">3</span>)
    <span class="kw">lines</span>(estint<span class="dv">-2</span>*esterr, <span class="dt">lty =</span> <span class="dv">3</span>)
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">valor=</span>estint[n], <span class="dt">error=</span><span class="dv">2</span>*esterr[n]))  
  } else <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">valor=</span><span class="kw">mean</span>(fx), <span class="dt">error=</span><span class="dv">2</span>*<span class="kw">sd</span>(fx)/<span class="kw">sqrt</span>(n)))
}  

<span class="kw">set.seed</span>(<span class="dv">54321</span>)
res &lt;-<span class="st"> </span><span class="kw">mc.integral</span>(ftn, a, b, <span class="dv">500</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> teor)</code></pre></div>
<p><img src="10-Reduccion_varianza_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res</code></pre></div>
<pre><code>## $valor
## [1] 3.184612
## 
## $error
## [1] 0.1619886</code></pre>
<p>Para la integración Monte Carlo con variables antitéticas podríamos considerar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mc.integrala &lt;-<span class="st"> </span>function(ftn, a, b, n, <span class="dt">plot=</span><span class="ot">TRUE</span>,...) {
  <span class="co"># n es el nº de evaluaciones de la función objetivo (para facilitar comparaciones, solo se genera la mitad)</span>
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n%/%<span class="dv">2</span>, a, b)
  <span class="co"># La siguiente línea solo para representar alternando</span>
  x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(x,a+b-x),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>))
  <span class="co"># bastaría con emplear p.e. c(x,a+b-x)</span>
  fx &lt;-<span class="st"> </span><span class="kw">sapply</span>(x, ftn)*(b-a)
  if (plot) {
    estint &lt;-<span class="st"> </span><span class="kw">cumsum</span>(fx)/(<span class="dv">1</span>:n)
    esterr &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">cumsum</span>((fx-estint)^<span class="dv">2</span>))/(<span class="dv">1</span>:n)
    <span class="kw">plot</span>(estint, <span class="dt">ylab=</span><span class="st">&quot;Media y rango de error&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,
         <span class="dt">ylim=</span><span class="kw">mean</span>(fx)+<span class="dv">2</span>*<span class="kw">c</span>(-esterr[<span class="dv">1</span>],esterr[<span class="dv">1</span>]),<span class="dt">xlab=</span><span class="st">&quot;Iteraciones&quot;</span>,...)
    <span class="kw">abline</span>(<span class="dt">h =</span> estint[n], <span class="dt">lty=</span><span class="dv">2</span>)
    <span class="kw">lines</span>(estint<span class="dv">+2</span>*esterr, <span class="dt">lty =</span> <span class="dv">3</span>)
    <span class="kw">lines</span>(estint<span class="dv">-2</span>*esterr, <span class="dt">lty =</span> <span class="dv">3</span>)
    <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">valor=</span>estint[n],<span class="dt">error=</span><span class="dv">2</span>*esterr[n]))
  } else <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">valor=</span><span class="kw">mean</span>(fx),<span class="dt">error=</span><span class="dv">2</span>*<span class="kw">sd</span>(fx)/<span class="kw">sqrt</span>(n)))
}

<span class="kw">set.seed</span>(<span class="dv">54321</span>)
res &lt;-<span class="st"> </span><span class="kw">mc.integrala</span>(ftn, a, b, <span class="dv">500</span>)</code></pre></div>
<p><img src="10-Reduccion_varianza_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res</code></pre></div>
<pre><code>## $valor
## [1] 3.222366
## 
## $error
## [1] 0.1641059</code></pre>
<p>Pero aunque aparentemente converge antes, parece no haber una mejora en la precisión de la aproximación. Si calculamos el porcentaje (estimado) de reducción del error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">100</span>*(<span class="fl">0.1619886-0.1641059</span>)/<span class="fl">0.1619886</span></code></pre></div>
<pre><code>## [1] -1.307067</code></pre>
<p>El problema es que en este caso se está estimando mal la varianza (asumiendo independencia). Hay que tener cuidado con las técnicas de reducción de la varianza si uno de los objetivos de la simulación es precisamente estimar la variabilidad. En este caso, una versión de la función anterior para integración Monte Carlo con variables antitéticas, con aproximación del error bajo dependencia podría ser:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mc.integrala2 &lt;-<span class="st"> </span>function(ftn, a, b, n, <span class="dt">plot =</span> <span class="ot">TRUE</span>,...) {
  <span class="co"># n es el nº de evaluaciones de la función objetivo (para facilitar comparaciones, solo se genera la mitad)</span>
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n%/%<span class="dv">2</span>, a, b)
  <span class="co"># La siguiente línea solo para representar alternando</span>
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(x,a+b-x),<span class="dt">nrow=</span><span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)
  <span class="co"># bastaría con emplear p.e. c(x,a+b-x)</span>
  fx &lt;-<span class="st"> </span><span class="kw">apply</span>(x, <span class="dv">1</span>,  ftn)*(b-a)
  corr &lt;-<span class="st"> </span><span class="kw">cor</span>(fx[,<span class="dv">1</span>], fx[,<span class="dv">2</span>])
  fx &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(fx)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">valor=</span><span class="kw">mean</span>(fx), <span class="dt">error=</span><span class="dv">2</span>*<span class="kw">sd</span>(fx)/<span class="kw">sqrt</span>(n)*<span class="kw">sqrt</span>(<span class="dv">1</span>+corr)))
}

<span class="kw">set.seed</span>(<span class="dv">54321</span>)
res &lt;-<span class="st"> </span><span class="kw">mc.integrala2</span>(ftn, a, b, <span class="dv">500</span>)
res</code></pre></div>
<pre><code>## $valor
## [1] 3.222366
## 
## $error
## [1] 0.05700069</code></pre>
<p>Porcentaje estimado de reducción del error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">100</span>*(<span class="fl">0.1619886-0.05700069</span>)/<span class="fl">0.1619886</span></code></pre></div>
<pre><code>## [1] 64.81191</code></pre>
<p>En este caso puede verse que la reducción teórica de la varianza es del 96.7%</p>
</div>
</div>
<div id="estratificacion" class="section level2">
<h2><span class="header-section-number">10.3</span> Estratificación</h2>
<p>Si se divide la población en estratos y se genera en cada uno un número de observaciones proporcional a su tamaño (a la probabilidad de cada uno) nos aseguramos de que se cubre el dominio de interés y se puede acelerar la convergencia.</p>
<ul>
<li>Por ejemplo, para generar una muestra de tamaño <span class="math inline">\(n\)</span> de una <span class="math inline">\(\mathcal{U}\left( 0,1\right)\)</span>, se pueden generar <span class="math inline">\(l=\frac{n}{k}\)</span> observaciones (<span class="math inline">\(1\leq k\leq n\)</span>) de la forma: <span class="math display">\[U_{j_{1}},\ldots,U_{j_{l}}\sim \mathcal{U}\left(  \frac{(j-1)}{k},\frac{j}{k}\right)  \text{ para }j=1,...,k.\]</span></li>
</ul>
<p>Si en el número de obsevaciones se tiene en cuenta la variabilidad en el estrato se puede obtener una reducción significativa de la varianza.</p>

<div class="example">
<span id="exm:unnamed-chunk-9" class="example"><strong>Ejemplo 10.1  </strong></span>Muestreo estratificado de una exponencial (libro Ricardo)
</div>
<p></p>
<p>Supóngase el siguiente problema (absolutamente artificial pero ilustrativo para comprender esta técnica). Dada una muestra de tamaño 10 de una población con distribución: <span class="math display">\[X \sim \exp\left( 1 \right),\]</span> se desea aproximar la media poblacional (es sobradamente conocido que es 1) a partir de 10 simulaciones. Supongamos que para evitar que, por puro azar, exista alguna zona en la que la exponencial toma valores, no representada en la muestra simulada de 10 datos, se consideran tres estratos. Por ejemplo, el del 40% de valores menores, el siguiente 50% de valores (intermedios) y el 10% de valores más grandes para esta distribución.</p>
<p>El algoritmo de inversión (optimizado) para simular una <span class="math inline">\(\exp\left(1\right)\)</span> es:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U\sim U\left( 0,1\right)\)</span>.</p></li>
<li><p>Hacer <span class="math inline">\(X=-\ln U\)</span>.</p></li>
</ol>
<p>Dado que, en principio, simulando diez valores <span class="math inline">\(U_{1},U_{2},\ldots,U_{10}\sim U\left( 0,1\right)\)</span>, no hay nada que nos garantice que las proporciones de los estratos son las deseadas (aunque sí lo serán en media). Una forma de garantizar el que obtengamos <strong>4, 5 y 1</strong> valores, repectivamente, en cada uno de los tres estratos, consiste en simular:</p>
<ul>
<li><p>4 valores de <span class="math inline">\(U[0.6,1)\)</span> para el primer estrato,</p></li>
<li><p>5 valores de <span class="math inline">\(U[0.1,0.6)\)</span> para el segundo y</p></li>
<li><p>uno de <span class="math inline">\(U[0,0.1)\)</span> para el tercero.</p></li>
</ul>
<p>Otra forma de proceder consistiría en rechazar valores de <span class="math inline">\(U\)</span> que caigan en uno de esos tres intervalos cuando el cupo de ese estrato esté ya lleno (lo cual no sería computacionalmente eficiente).</p>
<p>El algoritmo con la estratificación propuesta sería como sigue:</p>
<ol style="list-style-type: decimal">
<li><p>Para <span class="math inline">\(i=1,2,\ldots, 10\)</span>:</p></li>
<li><p>Generar <span class="math inline">\(U_{i}\)</span>:</p>
<p>2a. Generar <span class="math inline">\(U\sim U\left( 0,1\right)\)</span>.</p>
<p>2b. Si <span class="math inline">\(i\leq4\)</span> hacer <span class="math inline">\(U_{i} = 0.4 \cdot U + 0.6\)</span>.</p>
<p>2c. Si <span class="math inline">\(4&lt;i\leq9\)</span> hacer <span class="math inline">\(U_{i} = 0.5 \cdot U + 0.1\)</span>.</p>
<p>2d. Si <span class="math inline">\(i=10\)</span> hacer <span class="math inline">\(U_{i} = 0.1 \cdot U\)</span>.</p></li>
<li><p>Devolver <span class="math inline">\(X_{i}=-\ln U_{i}\)</span>.</p></li>
</ol>
<p>No es difícil probar que:</p>
<ul>
<li><p><span class="math inline">\(Var\left( X_{i}\right) = 0.0214644\)</span> si <span class="math inline">\(i=1,2,3,4\)</span>,</p></li>
<li><p><span class="math inline">\(Var\left( X_{i}\right) = 0.229504\)</span> si <span class="math inline">\(i=5,6,7,8,9\)</span> y</p></li>
<li><p><span class="math inline">\(Var\left( X_{10}\right) = 1\)</span>.</p></li>
</ul>
<p>Como consecuencia: <span class="math display">\[Var\left(  \overline{X}\right)  =\frac{1}{10^{2}}\sum_{i=1}^{10}
Var\left( X_{i} \right)  = 0.022338\]</span> que es bastante menor que 1 (la varianza en el caso de muestreo aleatorio simple no estratificado).</p>

<div class="exercise">
<span id="exr:unnamed-chunk-10" class="exercise"><strong>Ejercicio 2.3  </strong></span>Integración Monte Carlo con estratificación
</div>
<p></p>
<p>Aproximar la integral anterior empleando la técnica de estratificación, considerando <span class="math inline">\(k\)</span> subintervalos regularmente espaciados en el intervalo <span class="math inline">\(\left[ 0, 2 \right]\)</span>. ¿Como varía la reducción en la varianza dependiendo del valor de <span class="math inline">\(k\)</span>?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mc.integrale &lt;-<span class="st"> </span>function(ftn, a, b, n, k) {
  <span class="co"># Integración Monte Carlo con estratificación</span>
  l &lt;-<span class="st"> </span>n%/%k
  int &lt;-<span class="st"> </span><span class="kw">seq</span>(a, b, <span class="dt">len=</span>k<span class="dv">+1</span>)
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(l*k, <span class="kw">rep</span>(int[-(k<span class="dv">+1</span>)], <span class="dt">each=</span>l), <span class="kw">rep</span>(int[-<span class="dv">1</span>], <span class="dt">each=</span>l))
  <span class="co"># l uniformes en cada uno de los intervalos [(j-1)/k , j/k]</span>
  fx &lt;-<span class="st"> </span><span class="kw">sapply</span>(x, ftn)*(b-a)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">valor=</span><span class="kw">mean</span>(fx), <span class="dt">error=</span><span class="dv">2</span>*<span class="kw">sd</span>(fx)/<span class="kw">sqrt</span>(n)))   <span class="co"># error mal calculado</span>
}

<span class="kw">set.seed</span>(<span class="dv">54321</span>)
res &lt;-<span class="st"> </span><span class="kw">mc.integral</span>(ftn, a, b, <span class="dv">500</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> teor)</code></pre></div>
<p><img src="10-Reduccion_varianza_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res</code></pre></div>
<pre><code>## $valor
## [1] 3.184612
## 
## $error
## [1] 0.1619886</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
<span class="kw">mc.integrale</span>(ftn, a, b, <span class="dv">500</span>, <span class="dv">50</span>)</code></pre></div>
<pre><code>## $valor
## [1] 3.193338
## 
## $error
## [1] 0.1597952</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
<span class="kw">mc.integrale</span>(ftn, a, b, <span class="dv">500</span>, <span class="dv">100</span>)</code></pre></div>
<pre><code>## $valor
## [1] 3.193927
## 
## $error
## [1] 0.1599089</code></pre>
<p>De esta forma no se tiene en cuenta la variabilidad en el estrato. El tamaño de las submuestras debería incrementarse hacia el extremo superior.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-12" class="exercise"><strong>Ejercicio 10.1  </strong></span>
</div>
<p> Repetir el ejemplo anterior considerando intervalos regularmente espaciados en escala exponencial.</p>
</div>
<div id="variables-de-control" class="section level2">
<h2><span class="header-section-number">10.4</span> Variables de control</h2>
<p>En este caso se trata de sacar partido tanto a una covarianza positiva como negativa. La idea básica es emplear una variable <span class="math inline">\(Y\)</span>, con media conocida <span class="math inline">\(\mu_{Y}\)</span>, para controlar la variable <span class="math inline">\(X\)</span> (con media desconocida), de forma que ambas variables estén “suficientemente” correlacionadas. La versión “controlada” de <span class="math inline">\(X\)</span> será: <span class="math display">\[X^{\ast}=X+\alpha \left(  Y-\mu_{Y}\right)\]</span> con <span class="math inline">\(E(X^{\ast})=E(X)=\theta\)</span>. Puede verse que <span class="math inline">\(Var(X^{\ast})=Var(X)+\alpha^{2}Var(Y)+2\alpha Cov(X,Y)\)</span> es mínima para: <span class="math display">\[\alpha^{\ast}=-\frac{Cov(X,Y)}{Var(Y)},\]</span> con <span class="math inline">\(Var(X^{\ast}) = Var(X) \left( 1-\rho^{2} \left( X, Y \right) \right)\)</span> (lo que supone una reducción del <span class="math inline">\(100\rho^{2}\left( X, Y \right) \%\)</span>).</p>
<p>En la práctica normalmente <span class="math inline">\(\alpha^{\ast}\)</span> no es conocida. Para estimarlo se puede realizar ajuste lineal de <span class="math inline">\(X\)</span> sobre <span class="math inline">\(Y\)</span> (a partir de los datos simulados <span class="math inline">\(X_{i}\)</span> e <span class="math inline">\(Y_{i}\)</span>, <span class="math inline">\(1\leq i\leq n\)</span>):</p>
<ul>
<li><p>Si <span class="math inline">\(\hat{x}=\hat{\beta}_{0}+\hat{\beta}_{1}y\)</span> es la recta ajustada, con <span class="math inline">\(\hat{\beta}_{1} = \dfrac{S_{XY}}{S_{Y}^{2}}\)</span> y <span class="math inline">\(\hat{\beta}_{0} = \overline{X}-\hat{\beta}_{1}\overline{Y}\)</span>, la estimación sería: <span class="math display">\[\hat{\alpha}^{\ast}=-\hat{\beta}_{1}\]</span></p></li>
<li><p>Adicionalmente, para aproximar <span class="math inline">\(\theta\)</span>: <span class="math display">\[\begin{aligned}
\hat{\theta} &amp; =\overline{X}^{\ast}=\overline{X}-\hat{\beta}_{1}\left( \overline{Y}-\mu_{Y}\right) \\  
&amp; =\hat{\beta}_{0}+\hat{\beta}_{1}\mu_{Y}
\end{aligned}\]</span></p></li>
<li><p>Si <span class="math inline">\(\mu_{Y}=0\Rightarrow \hat{\theta}=\overline{X}^{\ast}=\hat{\beta}_{0}\)</span>.</p></li>
</ul>

<div class="exercise">
<span id="exr:unnamed-chunk-13" class="exercise"><strong>Ejercicio 7.3  </strong></span>Integración Monte Carlo con variables de control
</div>
<p></p>
<p>Aproximar la integral anterior empleando la variable <span class="math inline">\(U\sim\mathcal{U}(0,2)\)</span> para controlar la variable <span class="math inline">\(e^{U}\)</span>.</p>
<p>Se trata de calcular la media de <span class="math inline">\(exp(\mathcal{U}(a,b))\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">0</span>; b &lt;-<span class="st"> </span><span class="dv">2</span>
teor &lt;-<span class="st"> </span>(<span class="kw">exp</span>(b)-<span class="kw">exp</span>(a))/(b-a)
teor</code></pre></div>
<pre><code>## [1] 3.194528</code></pre>
<p>Aproximación clásica por simulación:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">54321</span>)
nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(nsim, a, b)
expu &lt;-<span class="st"> </span><span class="kw">exp</span>(u)
<span class="kw">mean</span>(expu) </code></pre></div>
<pre><code>## [1] 3.182118</code></pre>
<p>Con variable control:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(u, expu)
reg &lt;-<span class="st"> </span><span class="kw">lm</span>(expu ~<span class="st"> </span>u)$coef
<span class="kw">abline</span>(reg, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</code></pre></div>
<p><img src="10-Reduccion_varianza_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># summary(lm(expu ~ u)) # R-squared: 0.9392</span>
reg[<span class="dv">1</span>]+reg[<span class="dv">2</span>] <span class="co"># Coincidirá con la solución mean(expuc)</span></code></pre></div>
<pre><code>## (Intercept) 
##    3.204933</code></pre>
<p>Lo siguiente ya no sería necesario:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">expuc &lt;-<span class="st"> </span>expu -<span class="st"> </span>reg[<span class="dv">2</span>]*(u<span class="dv">-1</span>)
<span class="kw">mean</span>(expuc)  </code></pre></div>
<pre><code>## [1] 3.204933</code></pre>
<p>Estimación del porcentaje de reducción en la varianza:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">100</span>*(<span class="kw">var</span>(expu)-<span class="kw">var</span>(expuc))/<span class="kw">var</span>(expu)</code></pre></div>
<pre><code>## [1] 93.91555</code></pre>
</div>
<div id="numeros-aleatorios-comunes" class="section level2">
<h2><span class="header-section-number">10.5</span> Números aleatorios comunes</h2>
<p>Se trataría de una técnica básica del diseño de experimentos: realizar comparaciones homogéneas (bloquear). Por ejemplo cuando se diseña un experimento para la comparación de la media de dos variables, se pueden emplear las denominadas muestras apareadas, en lugar de muestras independientes.</p>
<p>Supóngamos que estamos interesados en las diferencias entre dos estrategias (e.g. dos estimadores): <span class="math display">\[E\left(  X\right)  -E\left(  Y\right)  =E\left(  X-Y\right).\]</span></p>
<p>Para ello se generan dos secuencias <span class="math inline">\(X_{1}\)</span>, <span class="math inline">\(X_{2}\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(X_{n}\)</span>, e <span class="math inline">\(Y_{1}\)</span>, <span class="math inline">\(Y_{2}\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(Y_{n}\)</span> y se calcula: <span class="math display">\[\overline{X}-\overline{Y}=\frac{1}{n}\sum_{i=1}^{n}\left(  X_{i}-Y_{i}\right)\]</span></p>
<ul>
<li><p>Si las secuencias se generan de modo independiente: <span class="math display">\[Var\left( \overline{X} - \overline{Y} \right) 
= \frac{1}{n} \left( Var\left( X \right) + Var\left( Y \right) \right)\]</span></p></li>
<li><p>Si se generar las secuencias empleando<strong> la misma semilla</strong>, los datos son dependientes: <span class="math display">\[Cov\left( X_{i}, Y_{i} \right) &gt; 0\]</span> y tendríamos que: <span class="math display">\[\begin{aligned}
Var\left( \overline{X}-\overline{Y}\right)  &amp;
= \frac{1}{n^{2}}\sum_{i=1}^{N}Var\left( X_{i}-Y_{i}\right) 
= \frac{1}{n}Var\left( X_{i}-Y_{i}\right) \\
&amp; = \frac{1}{n}\left( Var\left( X_{i} \right) + Var\left( Y_{i} \right)
- 2Cov\left( X_{i},Y_{i} \right) \right) \\
&amp; \leq \frac{1}{n}\left( Var\left( X_{i} \right) 
+ Var\left( Y_{i}\right) \right)
\end{aligned}\]</span></p></li>
</ul>
<p>En el capítulo de aplicaciones de la simulación se empleó esta técnica para comparar distribuciones de estimadores…</p>
</div>
<div id="ejercicios-fin-de-practica" class="section level2">
<h2><span class="header-section-number">10.6</span> Ejercicios fin de práctica</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-19" class="exercise"><strong>Ejercicio 10.2  </strong></span>
</div>
<p></p>
<p>Aproximar mediante integración Monte Carlo (clásica) la media de una distribución exponencial de parámetro <span class="math inline">\(1/2\)</span>:<span class="math display">\[I=\int_{0}^{\infty}\frac{x}{2}e^{-\frac{x}{2}}dx\]</span> y representar gráficamente la aproximación en función de <span class="math inline">\(n\)</span>. Comparar los resultados con los obtenidos empleando variables antitéticas, ¿se produce una reducción en la varianza?</p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> Puede ser recomendable emplear el método de inversión para generar las muestras (antitéticas) de la exponencial.
</div>
<p></p>
<p>MC clásico:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
lambda &lt;-<span class="st"> </span><span class="fl">0.5</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
x &lt;-<span class="st"> </span>-<span class="st"> </span><span class="kw">log</span>(<span class="kw">runif</span>(nsim)) /<span class="st"> </span>lambda
<span class="co"># Aprox por MC da media </span>
<span class="kw">mean</span>(x) <span class="co"># valor teor 1/lambda = 2</span></code></pre></div>
<pre><code>## [1] 1.97439</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Aprox da precisión </span>
<span class="kw">var</span>(x)  </code></pre></div>
<pre><code>## [1] 3.669456</code></pre>
<p>MC con variables antitéticas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># xa &lt;-</span>
<span class="co"># mean(xa) # Aprox por MC da media (valor teor 1/lambda = 2)</span>
<span class="co"># var(xa)  # Aprox da precisión supoñendo independencia</span>
<span class="co"># corr &lt;- cor(x1,x2)</span>
<span class="co"># var(xa)*(1 + corr) # Estimación varianza supoñendo dependencia</span></code></pre></div>
<p>Estimación del porcentaje de reducción en la varianza</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 100*(var(x) - var(xa))/var(x)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulacion-de-distribuciones-multidimensionales.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pendiente-ejercicios-bookdown.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/10-Reduccion_varianza.Rmd",
"text": "Edit"
},
"download": ["Practicas_de_Simulacion.pdf", "Practicas_de_Simulacion.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
