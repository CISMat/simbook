<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Prácticas de Simulación</title>
  <meta name="description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Prácticas de Simulación" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Prácticas de Simulación" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén F. Casal (ruben.fcasal@udc.es)">


<meta name="date" content="2017-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="generacion-de-numeros-pseudoaleatorios-1.html">
<link rel="next" href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Prácticas de Simulación</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#introduccion"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#ventajas-de-la-simulacion-shannon-1975"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas de la simulación (Shannon, 1975):</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes-de-la-simulacion"><i class="fa fa-check"></i><b>1.1.2</b> Inconvenientes de la simulación:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-aleatorios-puros"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios-mediante-software"><i class="fa fa-check"></i><b>1.4.1</b> Generación de números pseudoaleatorios mediante software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#opciones"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generadores-congruenciales"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generador-congruencial-lineal-simple"><i class="fa fa-check"></i><b>3.1.1</b> Generador congruencial lineal (simple)</a></li>
<li class="chapter" data-level="3.1.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#periodo"><i class="fa fa-check"></i><b>3.1.2</b> Periodo</a></li>
<li class="chapter" data-level="3.1.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.3</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#analisis-de-la-calidad-de-un-generador"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#repeticion-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#baterias-de-contrastes"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#ejercicios-de-fin-de-practica"><i class="fa fa-check"></i><b>3.3</b> Ejercicios de fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html"><i class="fa fa-check"></i><b>4</b> Análisis de los resultados</a><ul>
<li class="chapter" data-level="4.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#convergencia"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a></li>
<li class="chapter" data-level="4.2" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#estimacion-de-la-precision"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#teorema-central-del-limite"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#determinacion-del-numero-de-generaciones"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#el-problema-de-la-dependencia"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia:</a><ul>
<li class="chapter" data-level="4.5.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#observaciones"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><i class="fa fa-check"></i><b>5</b> Aplicaciones de la simulación en Inferencia Estadística</a><ul>
<li class="chapter" data-level="5.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#aplicaciones-de-la-simulacion"><i class="fa fa-check"></i><b>5.1</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="5.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#distribucion-en-el-muestreo"><i class="fa fa-check"></i><b>5.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="5.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>5.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="5.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#contrastes-de-hipotesis"><i class="fa fa-check"></i><b>5.4</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="5.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#comparacion-de-estimadores"><i class="fa fa-check"></i><b>5.5</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="5.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="5.6.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#idea"><i class="fa fa-check"></i><b>5.6.1</b> Idea:</a></li>
<li class="chapter" data-level="5.6.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#metodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="5.6.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#ejemplo"><i class="fa fa-check"></i><b>5.6.3</b> Ejemplo</a></li>
<li class="chapter" data-level="5.6.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>5.6.4</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="5.6.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#graficos"><i class="fa fa-check"></i><b>5.6.5</b> Gráficos</a></li>
<li class="chapter" data-level="5.6.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>5.6.6</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html"><i class="fa fa-check"></i><b>6</b> Integración y Optimización Montecarlo</a><ul>
<li class="chapter" data-level="6.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#integracion-monte-carlo-clasica"><i class="fa fa-check"></i><b>6.1</b> Integración Monte Carlo (clásica)</a></li>
<li class="chapter" data-level="6.2" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="6.2.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#optimizacion-monte-carlo"><i class="fa fa-check"></i><b>6.3</b> Optimización Monte Carlo</a></li>
<li class="chapter" data-level="6.4" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#temple-simulado"><i class="fa fa-check"></i><b>6.4</b> Temple simulado</a></li>
<li class="chapter" data-level="6.5" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#algoritmos-geneticos"><i class="fa fa-check"></i><b>6.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html"><i class="fa fa-check"></i><b>7</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="7.1" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-inversion"><i class="fa fa-check"></i><b>7.1</b> Método de inversión</a></li>
<li class="chapter" data-level="7.2" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-aceptacion-rechazo"><i class="fa fa-check"></i><b>7.2</b> Método de aceptación-rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#ejercicios-1"><i class="fa fa-check"></i><b>7.3</b> Ejercicios</a></li>
<li class="chapter" data-level="7.4" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodos-especificos-para-generacion-de-distribuciones-notables"><i class="fa fa-check"></i><b>7.4</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html"><i class="fa fa-check"></i><b>8</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="8.1" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#ejercicios-2"><i class="fa fa-check"></i><b>8.1</b> Ejercicios</a></li>
<li class="chapter" data-level="8.2" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#metodos-especificos-para-generacion-de-distribuciones-notables-1"><i class="fa fa-check"></i><b>8.2</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html"><i class="fa fa-check"></i><b>9</b> Simulación de Distribuciones Multidimensionales</a><ul>
<li class="chapter" data-level="9.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#introduccion-1"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#factorizacion-de-la-matriz-de-covarianzas"><i class="fa fa-check"></i><b>9.2</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="9.3" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-condicional-e-incondicional"><i class="fa fa-check"></i><b>9.3</b> Simulación condicional e incondicional</a></li>
<li class="chapter" data-level="9.4" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-basada-en-copulas"><i class="fa fa-check"></i><b>9.4</b> Simulación basada en cópulas</a></li>
<li class="chapter" data-level="9.5" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-distribuciones-multidimensionales-discretas"><i class="fa fa-check"></i><b>9.5</b> Simulación de distribuciones multidimensionales discretas</a><ul>
<li class="chapter" data-level="9.5.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>9.5.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="9.5.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-tablas-de-contingencia"><i class="fa fa-check"></i><b>9.5.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#reduccion-de-la-varianza"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-antiteticas"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejemplo-integracion-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#generacion-de-variables-antiteticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#estratificacion"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-de-control"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#numeros-aleatorios-comunes"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejercicios-fin-de-practica"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pendiente-ejercicios-bookdown.html"><a href="pendiente-ejercicios-bookdown.html"><i class="fa fa-check"></i><b>11</b> Pendiente (ejercicios bookdown)</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-basica"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-complementaria"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html"><i class="fa fa-check"></i><b>A</b> Recursos para el aprendizaje de R</a><ul>
<li class="chapter" data-level="A.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#cursos"><i class="fa fa-check"></i><b>A.1</b> Cursos</a></li>
<li class="chapter" data-level="A.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#libros"><i class="fa fa-check"></i><b>A.2</b> Libros</a><ul>
<li class="chapter" data-level="A.2.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#iniciacion"><i class="fa fa-check"></i><b>A.2.1</b> Iniciación</a></li>
<li class="chapter" data-level="A.2.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#avanzados"><i class="fa fa-check"></i><b>A.2.2</b> Avanzados</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#material"><i class="fa fa-check"></i><b>A.3</b> Material</a></li>
<li class="chapter" data-level="A.4" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#ayuda"><i class="fa fa-check"></i><b>A.4</b> Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="integracion-numerica.html"><a href="integracion-numerica.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a><ul>
<li class="chapter" data-level="B.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#introduccion-2"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-unidimensional"><i class="fa fa-check"></i><b>B.2</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="B.2.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide"><i class="fa fa-check"></i><b>B.2.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.2.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.2.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.2.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.2.4" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-de-r"><i class="fa fa-check"></i><b>B.2.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-bidimensional"><i class="fa fa-check"></i><b>B.3</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="B.3.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#representacion-grafica"><i class="fa fa-check"></i><b>B.3.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.3.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide-1"><i class="fa fa-check"></i><b>B.3.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.3.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-r"><i class="fa fa-check"></i><b>B.3.3</b> Comandos R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Simulación</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analisis-de-los-resultados" class="section level1">
<h1><span class="header-section-number">Capítulo 4</span> Análisis de los resultados</h1>
<div id="convergencia" class="section level2">
<h2><span class="header-section-number">4.1</span> Convergencia</h2>
<p>Supongamos que estamos interesados en aproximar la media teórica <span class="math inline">\(E\left( X\right)\)</span> a partir de una secuencia i.i.d. <span class="math inline">\(X_{1}\)</span>, <span class="math inline">\(X_{2}\)</span>, <span class="math inline">\(\cdots\)</span>, <span class="math inline">\(X_{n}\)</span> mediante la media muestral <span class="math inline">\(\bar{X}_{n}\)</span> (probabilidad caso particular). Una justificación teórica de la validez de la aproximación obtenida mediante simulación es <em>la ley (débil) de los grandes números</em>:</p>
<ul>
<li><p>Si <span class="math inline">\(X_{1}\)</span>, <span class="math inline">\(X_{2}\)</span>, <span class="math inline">\(\cdots\)</span> es una secuencia de v.a.’s independientes con: <span class="math display">\[E\left( X_{i}\right) =\mu \text{ y }Var\left( X_{i}\right) 
=\sigma^{2}&lt;\infty,\]</span> entonces <span class="math inline">\(\overline{X}_{n}=\left( X_{1}+\cdots +X_{n}\right) /n\)</span> converge en probabilidad a <span class="math inline">\(\mu\)</span>. i.e. para cualquier <span class="math inline">\(\varepsilon &gt;0\)</span>: <span class="math display">\[\lim\limits_{n\rightarrow \infty }P\left( \left\vert \overline{X}_{n}-\mu
\right\vert &lt;\varepsilon \right) = 1.\]</span></p></li>
<li><p><em>La ley fuerte</em> establece la convergencia casi segura.</p></li>
</ul>
<p><strong><em>Ejemplo</em></strong>: Aproximación de una probabilidad</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="fl">0.5</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
nsim &lt;-<span class="st"> </span><span class="dv">10000</span>
rx &lt;-<span class="st"> </span><span class="kw">runif</span>(nsim) &lt;=<span class="st"> </span>p
<span class="co"># Aproximación por simulación de p</span>
<span class="kw">mean</span>(rx) </code></pre></div>
<pre><code>## [1] 0.5047</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Evolución de la aproximación</span>
<span class="kw">plot</span>(<span class="kw">cumsum</span>(rx)/<span class="dv">1</span>:nsim, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">xlab=</span><span class="st">&quot;Número de generaciones&quot;</span>, 
     <span class="dt">ylab=</span><span class="st">&quot;Proporción muestral&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(rx), <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="co"># valor teórico</span>
<span class="kw">abline</span>(<span class="dt">h =</span> p) </code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Una suposición crucial es que las variables <span class="math inline">\(X_{i}\)</span> deben tener varianza finita (realmente esta suposición puede relajarse: <span class="math inline">\(E\left( \left\vert X_{i} \right\vert \right) &lt; \infty\)</span>). En caso contrario la media muestral puede no converger a una constante. Un ejemplo conocido es la distribución de Cauchy:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Problemas convergencia</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
nsim &lt;-<span class="st"> </span><span class="dv">10000</span>
rx &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(nsim)
<span class="kw">plot</span>(<span class="kw">cumsum</span>(rx)/<span class="dv">1</span>:nsim, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;Número de generaciones&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Media muestral&quot;</span>)</code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Es recomendable representar la evolución de la aproximación de la característica de interés (sobre el número de generaciones) para detectar problemas de convergencia. Además del análisis dewscriptivo de las simulaciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(rx)</code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="estimacion-de-la-precision" class="section level2">
<h2><span class="header-section-number">4.2</span> Estimación de la precisión</h2>
<p>En el caso de la media muestral <span class="math inline">\(\overline{X}_{n}\)</span>, un estimador insesgado de <span class="math inline">\(Var\left( \overline{X}_{n}\right) =\sigma ^{2}/n\)</span> es: <span class="math display">\[\widehat{Var}\left( \overline{X}_{n}\right) =\frac{\widehat{S}^{2}}{n}\]</span> con: <span class="math display">\[\widehat{S}_{n}^{2}=\dfrac{1}{n-1}\sum\limits_{i=1}^{n}\left( X_{i}-
\overline{X}\right) ^{2}.\]</span></p>
<p>En el caso de una proporción <span class="math inline">\(\hat{p}_{n}\)</span>: <span class="math display">\[\widehat{Var}\left( \hat{p}_{n}\right) 
=\frac{\hat{p}_{n}(1-\hat{p}_{n})}{n-1}.\]</span></p>
<p>Los valores obtenidos servirían como medidas básicas de la precisión de la aproximación, aunque su principal aplicación es la construcción de intervalos de confianza.</p>
</div>
<div id="teorema-central-del-limite" class="section level2">
<h2><span class="header-section-number">4.3</span> Teorema central del límite</h2>
<p>Si <span class="math inline">\(X_{1}\)</span>, <span class="math inline">\(X_{2}\)</span>, <span class="math inline">\(\cdots\)</span> es una secuencia de v.a.’s independientes con <span class="math inline">\(E\left( X_{i}\right) =\mu\)</span> y <span class="math inline">\(Var\left( X_{i}\right) = \sigma ^{2}&lt;\infty\)</span>, entonces: <span class="math display">\[Z_{n}=\frac{\overline{X}_{n}-\mu }{\frac{\sigma }{\sqrt{n}}}
\overset{d}{ \rightarrow } N(0,1)\]</span> i.e. <span class="math inline">\(\lim\limits_{n\rightarrow \infty }F_{Z_{n}}(z)=\Phi (z)\)</span>. Por tanto, un intervalo de confianza asintótico para <span class="math inline">\(\mu\)</span> es: <span class="math display">\[IC_{1-\alpha }(\mu ) = \left( \overline{X}_{n}
- z_{1-\alpha /2}\dfrac{\widehat{S}_{n}}{\sqrt{n}},\ 
\overline{X}+z_{1-\alpha /2}\dfrac{\widehat{S}_{n}}{\sqrt{n}} \right).\]</span></p>
<p>Podemos considerar que <span class="math inline">\(z_{1-\alpha /2}\dfrac{\widehat{S}_{n}}{\sqrt{n}}\)</span> es la precisión obtenida (con nivel de confianza <span class="math inline">\(1-\alpha\)</span>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Teorema central del límite</span>
xsd &lt;-<span class="st"> </span><span class="dv">1</span>
xmed &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
rx &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsim, xmed, xsd)
<span class="co"># Aproximación por simulación de la media</span>
<span class="kw">mean</span>(rx)</code></pre></div>
<pre><code>## [1] -0.01164814</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># &quot;Error&quot; de la aproximación</span>
<span class="dv">2</span>*<span class="kw">sd</span>(rx)/<span class="kw">sqrt</span>(nsim)</code></pre></div>
<pre><code>## [1] 0.06545382</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Evolución de la aproximación</span>
n &lt;-<span class="st"> </span><span class="dv">1</span>:nsim
est &lt;-<span class="st"> </span><span class="kw">cumsum</span>(rx)/n
esterr &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">cumsum</span>((rx-est)^<span class="dv">2</span>))/(n -<span class="st"> </span><span class="dv">1</span>)  <span class="co"># Error estandar</span>
<span class="kw">plot</span>(est, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">xlab=</span><span class="st">&quot;Número de generaciones&quot;</span>, 
     <span class="dt">ylab=</span><span class="st">&quot;Media y rango de error&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">h =</span> est[nsim], <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(est +<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">lines</span>(est -<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> xmed)</code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="determinacion-del-numero-de-generaciones" class="section level2">
<h2><span class="header-section-number">4.4</span> Determinación del número de generaciones</h2>
<p>En muchas ocasiones puede interesar obtener una aproximación con un nivel de precisión fijado.</p>
<p>Para una precisión absoluta <span class="math inline">\(\varepsilon\)</span>, se trata de determinar <span class="math inline">\(n\)</span> de forma que: <span class="math display">\[z_{1-\alpha /2}\dfrac{\widehat{S}_{n}}{\sqrt{n}}&lt;\varepsilon\]</span></p>
<p>Un algoritmo podría ser el siguiente:</p>
<ol style="list-style-type: decimal">
<li><p>Hacer <span class="math inline">\(j=0\)</span> y fijar un tamaño inicial <span class="math inline">\(n_{0}\)</span> (e.g. 30 ó 60).</p></li>
<li><p>Generar <span class="math inline">\(\left\{ X_{i}\right\} _{i=1}^{n_{0}}\)</span> y calcular <span class="math inline">\(\widehat{S}_{n_{0}}\)</span>.</p></li>
<li><p>Mientras <span class="math inline">\(\left. z_{1-\alpha /2}\widehat{S}_{n_{j-1}}\right/ \sqrt{n_{j}}&gt;\varepsilon\)</span> hacer:</p></li>
<li><p><span class="math inline">\(\qquad j=j+1\)</span>.</p></li>
<li><p><span class="math inline">\(\qquad n_{j}=\left\lceil \left( \left. z_{1-\alpha /2}\widehat{S}  _{n_{j-1}}\right/ \varepsilon \right)^{2}\right\rceil\)</span>.</p></li>
<li><p><span class="math inline">\(\qquad\)</span> Generar <span class="math inline">\(\left\{ X_{i}\right\}  _{i=n_{j-1}+1}^{n_{j}}\)</span> y calcular <span class="math inline">\(\widehat{S}_{n_{j}}\)</span>.</p></li>
</ol>
<p>Para una precisión relativa <span class="math inline">\(\varepsilon \left\vert \mu \right\vert\)</span> se procede análogamente de forma que:<span class="math display">\[z_{1-\alpha /2}\dfrac{\widehat{S}_{n}}{\sqrt{n}}&lt;\varepsilon \left\vert 
\overline{X}_{n}\right\vert .\]</span></p>
</div>
<div id="el-problema-de-la-dependencia" class="section level2">
<h2><span class="header-section-number">4.5</span> El problema de la dependencia:</h2>
<p>En el caso de dependencia, la estimación de la precisión se complica: <span class="math display">\[Var\left( \overline{X}\right) =\frac{1}{n^{2}}\left( 
\sum_{i=1}^{n}Var\left( X_{i} \right) + 2\sum_{i&lt;j}Cov\left( X_{i},X_{j}\right) \right).\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Variable dicotómica 0/1 (FALSE/TRUE)  </span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
nsim &lt;-<span class="st"> </span><span class="dv">10000</span>
<span class="co"># Tomamos como idea que en A Coruña llueve de media 1/3 días al año,</span>
<span class="co"># y suponemos que 0.656 es la prob de que llueva si el día </span>
<span class="co"># anterio llovió y 0.056 si no.</span>
<span class="co"># x == &quot;llueve&quot;</span>

alpha &lt;-<span class="st"> </span><span class="fl">0.03</span> <span class="co"># prob de lluvia si FALSE/0 (prob. de cambio)</span>
beta &lt;-<span class="st"> </span><span class="fl">0.94</span>  <span class="co"># prob de lluvia si TRUE/1 (prob. de cambio 0.06)</span>
rx &lt;-<span class="st"> </span><span class="kw">logical</span>(nsim)
rx[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># El primer día no llueve</span>
for (i in <span class="dv">2</span>:nsim)
  rx[i] &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) &lt;<span class="st"> </span>(if (rx[i<span class="dv">-1</span>]) beta else alpha)

n &lt;-<span class="st"> </span><span class="dv">1</span>:nsim
est &lt;-<span class="st"> </span><span class="kw">cumsum</span>(rx)/n
esterr &lt;-<span class="st"> </span><span class="kw">sqrt</span>(est*(<span class="dv">1</span>-est)/(n<span class="dv">-1</span>))</code></pre></div>
<p><strong>IMPORTANTE</strong>: Al ser datos dependientes esta estimación del error estandar no es adecuada.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(<span class="kw">as.numeric</span>(rx))</code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>En este caso al haber dependencia positiva se produce una subestimación del verdadero error estandar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(est, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, 
     <span class="dt">xlab=</span><span class="st">&quot;Número de simulaciones&quot;</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))
<span class="kw">abline</span>(<span class="dt">h =</span> est[nsim], <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(est +<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">lty=</span><span class="dv">2</span>) <span class="co"># OJO! Supone independencia</span>
<span class="kw">lines</span>(est -<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span>/<span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;darkgray&quot;</span>)     <span class="co"># Prob. teor. cadenas Markov</span></code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>El gráfico de autocorrelaciones sugiere que si tomamos 1 de cada 25 podemos suponer independencia.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lag &lt;-<span class="st"> </span><span class="dv">24</span>
xlag &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="ot">FALSE</span>, lag), <span class="ot">TRUE</span>)
rxi &lt;-<span class="st"> </span>rx[xlag]
<span class="kw">acf</span>(<span class="kw">as.numeric</span>(rxi))</code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">length</span>(rxi)
est &lt;-<span class="st"> </span><span class="kw">cumsum</span>(rxi)/n
esterr &lt;-<span class="st"> </span><span class="kw">sqrt</span>(est*(<span class="dv">1</span>-est)/(n<span class="dv">-1</span>))
<span class="kw">plot</span>(est, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, 
     <span class="dt">xlab=</span><span class="kw">paste</span>(<span class="st">&quot;Número de simulaciones /&quot;</span>, lag), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))
<span class="kw">abline</span>(<span class="dt">h =</span> est[<span class="kw">length</span>(rxi)], <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(est +<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">lty=</span><span class="dv">2</span>) <span class="co"># Supone independencia</span>
<span class="kw">lines</span>(est -<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span>/<span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;darkgray&quot;</span>)     <span class="co"># Prob. teor. cadenas Markov</span></code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<p>No será la proximación más eficiente…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rxi &lt;-<span class="st"> </span><span class="kw">matrix</span>(rx, <span class="dt">ncol =</span> lag -<span class="st"> </span><span class="dv">1</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning in matrix(rx, ncol = lag - 1, byrow = TRUE): la longitud de los
## datos [10000] no es un submúltiplo o múltiplo del número de filas [435] en
## la matriz</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(rxi)
for(i in <span class="dv">1</span>:<span class="kw">ncol</span>(rxi)) {
  est &lt;-<span class="st"> </span><span class="kw">cumsum</span>(rxi[,i])/n
  esterr &lt;-<span class="st"> </span><span class="kw">sqrt</span>(est*(<span class="dv">1</span>-est)/(n<span class="dv">-1</span>))
  if (i ==<span class="st"> </span><span class="dv">1</span>) 
    <span class="kw">plot</span>(est, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Probabilidad&quot;</span>, 
         <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;Número de simulaciones /&quot;</span>, lag), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))
  else <span class="kw">lines</span>(est)
  <span class="kw">lines</span>(est +<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>) <span class="co"># Supone independencia...</span>
  <span class="kw">lines</span>(est -<span class="st"> </span><span class="dv">2</span>*esterr, <span class="dt">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>)
}
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(rx), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span>/<span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;darkgray&quot;</span>)     <span class="co"># Prob. teor. cadenas Markov</span></code></pre></div>
<p><img src="04-Analisis_resultados_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Trataremos este tipo de problemas en la diagnosis de algoritmos de simulación Monte Carlo de Cadenas de Markov (MCMC). Aparecen también en la simulación dinámica (por eventos o cuantos).</p>
<div id="periodo-de-calentamiento" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Periodo de calentamiento</h3>

<div class="exercise">
<span id="exr:unnamed-chunk-10" class="exercise"><strong>Ejercicio 2.3  </strong></span>
</div>
<p> Repetir el ejemplo anterior considerando como punto de partida un día lluvioso.</p>
</div>
</div>
<div id="observaciones" class="section level2">
<h2><span class="header-section-number">4.6</span> Observaciones</h2>
<ul>
<li><p>En el caso de que la característica de interés de la distribución de <span class="math inline">\(X\)</span> no sea la media, los resultados anteriores no serían en principio aplicables.</p></li>
<li><p>Incluso en el caso de la media, las bandas de confianza obtenidas con el TCL son puntuales (si generamos nuevas secuencias de simulación es muy probable que no estén contenidas).</p></li>
<li><p>Se podría recurrir a la generación de múltiples secuencias (equivalentemente emplear un método de <em>macro-micro replicaciones</em> para la estimación de la varianza - <em>bach means</em>: medias por lotes).</p></li>
<li><p>En muchos casos la generación de múltiples secuencias de simulación puede suponer un coste computacional importante, por lo que puede ser preferible emplear un método de remuestreo.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generacion-de-numeros-pseudoaleatorios-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-Analisis_resultados.Rmd",
"text": "Edit"
},
"download": ["Practicas_de_Simulacion.pdf", "Practicas_de_Simulacion.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
