<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Prácticas de Simulación</title>
  <meta name="description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Prácticas de Simulación" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Prácticas de Simulación" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén F. Casal (ruben.fcasal@udc.es)">


<meta name="date" content="2017-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="simulacion-de-variables-continuas.html">
<link rel="next" href="simulacion-de-distribuciones-multidimensionales.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Prácticas de Simulación</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#introduccion"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#ventajas-de-la-simulacion-shannon-1975"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas de la simulación (Shannon, 1975):</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes-de-la-simulacion"><i class="fa fa-check"></i><b>1.1.2</b> Inconvenientes de la simulación:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-aleatorios-puros"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios-mediante-software"><i class="fa fa-check"></i><b>1.4.1</b> Generación de números pseudoaleatorios mediante software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#opciones"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generadores-congruenciales"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generador-congruencial-lineal-simple"><i class="fa fa-check"></i><b>3.1.1</b> Generador congruencial lineal (simple)</a></li>
<li class="chapter" data-level="3.1.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#periodo"><i class="fa fa-check"></i><b>3.1.2</b> Periodo</a></li>
<li class="chapter" data-level="3.1.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.3</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#analisis-de-la-calidad-de-un-generador"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#repeticion-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#baterias-de-contrastes"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#ejercicios-de-fin-de-practica"><i class="fa fa-check"></i><b>3.3</b> Ejercicios de fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html"><i class="fa fa-check"></i><b>4</b> Análisis de los resultados</a><ul>
<li class="chapter" data-level="4.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#convergencia"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a></li>
<li class="chapter" data-level="4.2" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#estimacion-de-la-precision"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#teorema-central-del-limite"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#determinacion-del-numero-de-generaciones"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#el-problema-de-la-dependencia"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia:</a><ul>
<li class="chapter" data-level="4.5.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#observaciones"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><i class="fa fa-check"></i><b>5</b> Aplicaciones de la simulación en Inferencia Estadística</a><ul>
<li class="chapter" data-level="5.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#aplicaciones-de-la-simulacion"><i class="fa fa-check"></i><b>5.1</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="5.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#distribucion-en-el-muestreo"><i class="fa fa-check"></i><b>5.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="5.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>5.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="5.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#contrastes-de-hipotesis"><i class="fa fa-check"></i><b>5.4</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="5.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#comparacion-de-estimadores"><i class="fa fa-check"></i><b>5.5</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="5.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="5.6.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#idea"><i class="fa fa-check"></i><b>5.6.1</b> Idea:</a></li>
<li class="chapter" data-level="5.6.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#metodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="5.6.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#ejemplo"><i class="fa fa-check"></i><b>5.6.3</b> Ejemplo</a></li>
<li class="chapter" data-level="5.6.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>5.6.4</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="5.6.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#graficos"><i class="fa fa-check"></i><b>5.6.5</b> Gráficos</a></li>
<li class="chapter" data-level="5.6.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>5.6.6</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html"><i class="fa fa-check"></i><b>6</b> Integración y Optimización Montecarlo</a><ul>
<li class="chapter" data-level="6.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#integracion-monte-carlo-clasica"><i class="fa fa-check"></i><b>6.1</b> Integración Monte Carlo (clásica)</a></li>
<li class="chapter" data-level="6.2" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="6.2.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#optimizacion-monte-carlo"><i class="fa fa-check"></i><b>6.3</b> Optimización Monte Carlo</a></li>
<li class="chapter" data-level="6.4" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#temple-simulado"><i class="fa fa-check"></i><b>6.4</b> Temple simulado</a></li>
<li class="chapter" data-level="6.5" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#algoritmos-geneticos"><i class="fa fa-check"></i><b>6.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html"><i class="fa fa-check"></i><b>7</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="7.1" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-inversion"><i class="fa fa-check"></i><b>7.1</b> Método de inversión</a></li>
<li class="chapter" data-level="7.2" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-aceptacion-rechazo"><i class="fa fa-check"></i><b>7.2</b> Método de aceptación-rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#ejercicios-1"><i class="fa fa-check"></i><b>7.3</b> Ejercicios</a></li>
<li class="chapter" data-level="7.4" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodos-especificos-para-generacion-de-distribuciones-notables"><i class="fa fa-check"></i><b>7.4</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html"><i class="fa fa-check"></i><b>8</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="8.1" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#ejercicios-2"><i class="fa fa-check"></i><b>8.1</b> Ejercicios</a></li>
<li class="chapter" data-level="8.2" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#metodos-especificos-para-generacion-de-distribuciones-notables-1"><i class="fa fa-check"></i><b>8.2</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html"><i class="fa fa-check"></i><b>9</b> Simulación de Distribuciones Multidimensionales</a><ul>
<li class="chapter" data-level="9.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#introduccion-1"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#factorizacion-de-la-matriz-de-covarianzas"><i class="fa fa-check"></i><b>9.2</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="9.3" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-condicional-e-incondicional"><i class="fa fa-check"></i><b>9.3</b> Simulación condicional e incondicional</a></li>
<li class="chapter" data-level="9.4" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-basada-en-copulas"><i class="fa fa-check"></i><b>9.4</b> Simulación basada en cópulas</a></li>
<li class="chapter" data-level="9.5" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-distribuciones-multidimensionales-discretas"><i class="fa fa-check"></i><b>9.5</b> Simulación de distribuciones multidimensionales discretas</a><ul>
<li class="chapter" data-level="9.5.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>9.5.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="9.5.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-tablas-de-contingencia"><i class="fa fa-check"></i><b>9.5.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#reduccion-de-la-varianza"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-antiteticas"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejemplo-integracion-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#generacion-de-variables-antiteticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#estratificacion"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-de-control"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#numeros-aleatorios-comunes"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejercicios-fin-de-practica"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pendiente-ejercicios-bookdown.html"><a href="pendiente-ejercicios-bookdown.html"><i class="fa fa-check"></i><b>11</b> Pendiente (ejercicios bookdown)</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-basica"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-complementaria"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html"><i class="fa fa-check"></i><b>A</b> Recursos para el aprendizaje de R</a><ul>
<li class="chapter" data-level="A.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#cursos"><i class="fa fa-check"></i><b>A.1</b> Cursos</a></li>
<li class="chapter" data-level="A.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#libros"><i class="fa fa-check"></i><b>A.2</b> Libros</a><ul>
<li class="chapter" data-level="A.2.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#iniciacion"><i class="fa fa-check"></i><b>A.2.1</b> Iniciación</a></li>
<li class="chapter" data-level="A.2.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#avanzados"><i class="fa fa-check"></i><b>A.2.2</b> Avanzados</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#material"><i class="fa fa-check"></i><b>A.3</b> Material</a></li>
<li class="chapter" data-level="A.4" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#ayuda"><i class="fa fa-check"></i><b>A.4</b> Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="integracion-numerica.html"><a href="integracion-numerica.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a><ul>
<li class="chapter" data-level="B.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#introduccion-2"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-unidimensional"><i class="fa fa-check"></i><b>B.2</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="B.2.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide"><i class="fa fa-check"></i><b>B.2.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.2.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.2.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.2.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.2.4" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-de-r"><i class="fa fa-check"></i><b>B.2.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-bidimensional"><i class="fa fa-check"></i><b>B.3</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="B.3.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#representacion-grafica"><i class="fa fa-check"></i><b>B.3.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.3.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide-1"><i class="fa fa-check"></i><b>B.3.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.3.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-r"><i class="fa fa-check"></i><b>B.3.3</b> Comandos R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Simulación</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulacion-de-variables-discretas" class="section level1">
<h1><span class="header-section-number">Capítulo 8</span> Simulación de variables discretas</h1>
<p><strong><em>Pendiente: ejemplos y teoría</em></strong></p>
<div id="ejercicios-2" class="section level2">
<h2><span class="header-section-number">8.1</span> Ejercicios</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-1" class="exercise"><strong>Ejercicio 5.1  </strong></span>
</div>
<p> Se pretende simular valores de una distribución <span class="math inline">\(\mathcal{B}(10,0.5)\)</span>. Para ello:</p>
<ol style="list-style-type: lower-alpha">
<li>Generar, por el método de la transformación cuantil usando búsqueda secuencial, una muestra de <span class="math inline">\(nsim=10^{5}\)</span> observaciones de esta variable. Obtener el tiempo de CPU empleado. Aproximar por simulación la función de masa de probabilidad, representarla gráficamente y compararla con la teórica. Calcular también la media muestral (compararla con la teórica <span class="math inline">\(np\)</span>) y el número medio de comparaciones para generar cada observación.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rfmp &lt;-<span class="st"> </span>function(x, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="kw">length</span>(x), <span class="dt">nsim =</span> <span class="dv">1000</span>) {
  <span class="co"># Simulación nsim v.a. discreta a partir de fmp</span>
  <span class="co"># por inversión generalizada (transformación cuantil)</span>
  <span class="co"># Inicializar FD</span>
  Fx &lt;-<span class="st"> </span><span class="kw">cumsum</span>(prob)
  <span class="co"># Simular</span>
  X &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
  U &lt;-<span class="st"> </span><span class="kw">runif</span>(nsim)
  for(j in <span class="dv">1</span>:nsim) {
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    while (Fx[i] &lt;<span class="st"> </span>U[j]) i &lt;-<span class="st"> </span>i +<span class="st"> </span><span class="dv">1</span>
    X[j] &lt;-<span class="st"> </span>x[i]
    ncomp &lt;&lt;-<span class="st"> </span>ncomp +<span class="st"> </span>i
  }
  <span class="kw">return</span>(X)
}


<span class="co"># Simular binomial</span>
<span class="kw">set.seed</span>(<span class="dv">54321</span>)
n &lt;-<span class="st"> </span><span class="dv">10</span>
p &lt;-<span class="st"> </span><span class="fl">0.5</span>
nsim &lt;-<span class="st"> </span><span class="dv">10</span>^<span class="dv">5</span>

x &lt;-<span class="st"> </span><span class="dv">0</span>:n
fmp &lt;-<span class="st"> </span><span class="kw">dbinom</span>(x, n, p)

ncomp &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">system.time</span>( rx &lt;-<span class="st"> </span><span class="kw">rfmp</span>(x, fmp, nsim) )</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.07    0.03    0.10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Aproximación media</span>
<span class="kw">mean</span>(rx)</code></pre></div>
<pre><code>## [1] 5.00322</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n*p</code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Número de comparaciones</span>
ncomp/nsim</code></pre></div>
<pre><code>## [1] 6.00322</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>((<span class="dv">1</span>:<span class="kw">length</span>(x))*fmp) <span class="co"># Valor teórico</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Análisis resultados</span>
res &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(rx)/nsim)
<span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;psim&quot;</span>)

<span class="co"># Comparación teórica</span>
<span class="kw">plot</span>(<span class="kw">as.matrix</span>(res), <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
<span class="kw">points</span>(x, fmp, <span class="dt">pch=</span><span class="dv">4</span>)</code></pre></div>
<p><img src="08-Discretas_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res$pteor &lt;-<span class="st"> </span>fmp
res</code></pre></div>
<pre><code>##     x    psim        pteor
## 1   0 0.00107 0.0009765625
## 2   1 0.00990 0.0097656250
## 3   2 0.04432 0.0439453125
## 4   3 0.11778 0.1171875000
## 5   4 0.20425 0.2050781250
## 6   5 0.24375 0.2460937500
## 7   6 0.20454 0.2050781250
## 8   7 0.11898 0.1171875000
## 9   8 0.04419 0.0439453125
## 10  9 0.01023 0.0097656250
## 11 10 0.00099 0.0009765625</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Errores</span>
<span class="kw">max</span>(<span class="kw">abs</span>(res$psim -<span class="st"> </span>res$pteor))</code></pre></div>
<pre><code>## [1] 0.00234375</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(<span class="kw">abs</span>(res$psim -<span class="st"> </span>res$pteor) /<span class="st"> </span>res$pteor)</code></pre></div>
<pre><code>## [1] 0.09568</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># NOTA: Puede ocurrir que no todos los valores sean generados en la simulación</span>
<span class="co"># Si length(x) &gt; length(psim) el código anterior (res$pteor &lt;- fmp) producirá un error</span>
<span class="co"># Alternativamente:</span>
res &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">pteor =</span> fmp, <span class="dt">psim =</span> <span class="dv">0</span>)
res.sim &lt;-<span class="st"> </span><span class="kw">table</span>(rx)/nsim
index &lt;-<span class="st"> </span><span class="kw">match</span>(<span class="kw">names</span>(res.sim), x)
res$psim[index] &lt;-<span class="st"> </span>res.sim
<span class="co"># entre muchas otras posibilidades...</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Repetir el apartado anterior ordenando previamente las probabilidades en orden decreciente y también empleando la función <code>sample</code> de R.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tini &lt;-<span class="st"> </span><span class="kw">proc.time</span>()

ncomp &lt;-<span class="st"> </span><span class="dv">0</span>
ind &lt;-<span class="st"> </span><span class="kw">order</span>(fmp, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)
rx &lt;-<span class="st"> </span><span class="kw">rfmp</span>(x[ind], fmp[ind], nsim)

tiempo &lt;-<span class="st"> </span><span class="kw">proc.time</span>() -<span class="st"> </span>tini
tiempo</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.05    0.01    0.05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Número de comparaciones</span>
ncomp/nsim</code></pre></div>
<pre><code>## [1] 3.08969</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>((<span class="dv">1</span>:<span class="kw">length</span>(x))*fmp[ind]) <span class="co"># Valor teórico</span></code></pre></div>
<pre><code>## [1] 3.083984</code></pre>
<p>Como se comentó en el Capítulo de <a href="numeros-aleatorios-en-r.html#numeros-aleatorios-en-r">Números aleatorios en R</a> en <code>R</code> se recomienda emplear la función <code>sample</code> (implementa eficientemente el método de Alias, descrito en el apartado d)): <code>sample(x, size, replace = FALSE, prob = NULL)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>( rx &lt;-<span class="st"> </span><span class="kw">sample</span>(x, nsim, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> fmp) )</code></pre></div>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Si n &gt;&gt; 30</span>
<span class="co"># Aproximación normal con corrección continuidad</span>
mean &lt;-<span class="st"> </span>n*p
sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n*p*(<span class="dv">1</span>-p))
<span class="co"># curve(dnorm(x, mean, sd), add = TRUE, col=&#39;blue&#39;)</span>

res$pnorm &lt;-<span class="st"> </span><span class="kw">pnorm</span>(x<span class="fl">+0.5</span>,mean,sd)-<span class="kw">pnorm</span>(x<span class="fl">-0.5</span>,mean,sd)
res</code></pre></div>
<pre><code>##     x        pteor    psim       pnorm
## 1   0 0.0009765625 0.00107 0.001961154
## 2   1 0.0097656250 0.00990 0.011215085
## 3   2 0.0439453125 0.04432 0.043494801
## 4   3 0.1171875000 0.11778 0.114467707
## 5   4 0.2050781250 0.20425 0.204523961
## 6   5 0.2460937500 0.24375 0.248170366
## 7   6 0.2050781250 0.20454 0.204523961
## 8   7 0.1171875000 0.11898 0.114467707
## 9   8 0.0439453125 0.04419 0.043494801
## 10  9 0.0097656250 0.01023 0.011215085
## 11 10 0.0009765625 0.00099 0.001961154</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(<span class="kw">abs</span>(res$pnorm -<span class="st"> </span>res$pteor))</code></pre></div>
<pre><code>## [1] 0.002719793</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(<span class="kw">abs</span>(res$pnorm -<span class="st"> </span>res$pteor) /<span class="st"> </span>res$pteor)</code></pre></div>
<pre><code>## [1] 1.008222</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>( rx &lt;-<span class="st"> </span><span class="kw">pmax</span>(<span class="dv">0</span>, <span class="kw">pmin</span>(n, <span class="kw">round</span>( <span class="kw">rnorm</span>(nsim, mean, sd) ))) )</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.02    0.00    0.02</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(rx)/nsim</code></pre></div>
<pre><code>## rx
##       0       1       2       3       4       5       6       7       8 
## 0.00216 0.01107 0.04317 0.11406 0.20454 0.24924 0.20373 0.11500 0.04352 
##       9      10 
## 0.01121 0.00230</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Realmente las prob de los extremos serían mayores...</span>
res$pnorm[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">pnorm</span>(<span class="fl">0.5</span>, mean, sd)
res$pnorm[n<span class="dv">+1</span>] &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">pnorm</span>(n<span class="fl">-0.5</span>, mean, sd)</code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Diseñar una rutina que permita generar <span class="math inline">\(nsim\)</span> valores de una distribución discreta usando una tabla guía. Repetir los pasos de los apartados anteriores empleando esta rutina (con <span class="math inline">\(m=n-1\)</span>).</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rfmp.tabla &lt;-<span class="st"> </span>function(x, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="kw">length</span>(x), m, <span class="dt">nsim =</span> <span class="dv">1000</span>) {
  <span class="co"># Simulación v.a. discreta a partir de función de masa de probabilidad</span>
  <span class="co"># por tabla guia de tamaño m</span>
  <span class="co"># Inicializar tabla y FD</span>
  Fx &lt;-<span class="st"> </span><span class="kw">cumsum</span>(prob)
  g &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,m)
  i &lt;-<span class="st"> </span><span class="dv">1</span>
  for(j in <span class="dv">2</span>:m) {
    while (Fx[i] &lt;<span class="st"> </span>(j<span class="dv">-1</span>)/m) i &lt;-<span class="st"> </span>i<span class="dv">+1</span>
    g[j] &lt;-<span class="st"> </span>i
  }
  <span class="co"># Generar valores</span>
  X &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
  U &lt;-<span class="st"> </span><span class="kw">runif</span>(nsim)
  for(j in <span class="dv">1</span>:nsim) {
    i &lt;-<span class="st"> </span>g[<span class="kw">floor</span>(U[j]*m)+<span class="dv">1</span>]
    while (Fx[i] &lt;<span class="st"> </span>U[j]) i &lt;-<span class="st"> </span>i +<span class="st"> </span><span class="dv">1</span>
    X[j] &lt;-<span class="st"> </span>x[i]
  }
  <span class="kw">return</span>(X)
}

<span class="kw">system.time</span>( rx &lt;-<span class="st"> </span><span class="kw">rfmp.tabla</span>(x, fmp, n<span class="dv">-1</span>, nsim) )</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.06    0.01    0.07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Análisis resultados</span>
res &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(rx)/nsim)
<span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;psim&quot;</span>)

<span class="co"># Comparación teórica</span>
<span class="kw">plot</span>(<span class="kw">as.matrix</span>(res), <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
<span class="kw">points</span>(x, fmp, <span class="dt">pch=</span><span class="dv">4</span>)</code></pre></div>
<p><img src="08-Discretas_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Diseñar una rutina que permita generar <span class="math inline">\(nsim\)</span> valores de una distribución discreta usando el método de Alias. Repetir los pasos de los apartados anteriores empleando esta rutina. Comparar los resultados obtenidos.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rfmp.alias &lt;-<span class="st"> </span>function(x, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="kw">length</span>(x), <span class="dt">nsim =</span> <span class="dv">1000</span>) {
  <span class="co"># Inicializar tablas</span>
  a &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))
  q &lt;-<span class="st"> </span>prob*<span class="kw">length</span>(x)
  low &lt;-<span class="st"> </span>q &lt;<span class="st"> </span><span class="dv">1</span>
  high &lt;-<span class="st"> </span><span class="kw">which</span>(!low)
  low &lt;-<span class="st"> </span><span class="kw">which</span>(low)
  while (<span class="kw">length</span>(high) &amp;&amp;<span class="st"> </span><span class="kw">length</span>(low)) {
    l &lt;-<span class="st"> </span>low[<span class="dv">1</span>]
    h &lt;-<span class="st"> </span>high[<span class="dv">1</span>]
    a[l] &lt;-<span class="st"> </span>h
    q[h] &lt;-<span class="st"> </span>q[h] -<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>q[l])
    if (q[h] &lt;<span class="st"> </span><span class="dv">1</span>) {
      high &lt;-<span class="st"> </span>high[-<span class="dv">1</span>]
      low[<span class="dv">1</span>] &lt;-<span class="st"> </span>h
    } else low &lt;-<span class="st"> </span>low[-<span class="dv">1</span>]
  } <span class="co"># while</span>
  <span class="co"># Generar valores</span>
  V &lt;-<span class="st"> </span><span class="kw">runif</span>(nsim)
  i &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">runif</span>(nsim)*<span class="kw">length</span>(x)) +<span class="st"> </span><span class="dv">1</span>
  <span class="kw">return</span>( x[ <span class="kw">ifelse</span>( V &lt;<span class="st"> </span>q[i], i, a[i]) ] )
}


<span class="kw">system.time</span>( rx &lt;-<span class="st"> </span><span class="kw">rfmp.alias</span>(x,fmp,nsim) )</code></pre></div>
<pre><code>##    user  system elapsed 
##    0.04    0.04    0.05</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Análisis resultados</span>
res &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(rx)/nsim)
<span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;psim&quot;</span>)

<span class="co"># Comparación teórica</span>
<span class="kw">plot</span>(<span class="kw">as.matrix</span>(res), <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
<span class="kw">points</span>(x, fmp, <span class="dt">pch=</span><span class="dv">4</span>)</code></pre></div>
<p><img src="08-Discretas_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>

<div class="exercise">
<span id="exr:unnamed-chunk-7" class="exercise"><strong>Ejercicio 2.2  </strong></span>
</div>
<p> Considera la variable aleatoria con función de distribución dada por: <span class="math display">\[F(x)=\left\{
\begin{array}
[c]{cl}0 &amp; \mbox{si $x&lt;0$}\\
\frac{x}{2}+\frac{1}{10} &amp; \mbox{si $x\in[0,\frac{1}{5})$}\\
x+\frac{1}{10} &amp; \mbox{si $x\in[\frac{1}{5},\frac{9}{10}]$}\\
1 &amp; \mbox{en otro caso}
\end{array}
\right.\]</span></p>
<p>Función de distribución:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fdistr &lt;-<span class="st"> </span>function(x) {
<span class="kw">ifelse</span>(x &lt;<span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>,
    <span class="kw">ifelse</span>(x &lt;<span class="st"> </span><span class="dv">1</span>/<span class="dv">5</span>, x/<span class="dv">2</span> +<span class="st"> </span><span class="dv">1</span>/<span class="dv">10</span>,
        <span class="kw">ifelse</span>(x &lt;=<span class="st"> </span><span class="dv">9</span>/<span class="dv">10</span>, x +<span class="st"> </span><span class="dv">1</span>/<span class="dv">10</span>, <span class="dv">1</span>) ) )
}
<span class="co"># Empleando ifelse se complica un poco más pero el resultado es una función vectorial.</span>
<span class="kw">curve</span>(<span class="kw">fdistr</span>(x), <span class="dt">from =</span> -<span class="fl">0.1</span>, <span class="dt">to =</span> <span class="fl">1.1</span>, <span class="dt">type =</span> <span class="st">&#39;s&#39;</span>, 
      <span class="dt">main =</span> <span class="st">&#39;Función de distribución&#39;</span>)
<span class="co"># Discontinuidades en 0 y 1/5</span>
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">10</span>, <span class="dv">2</span>/<span class="dv">10</span>, <span class="dv">3</span>/<span class="dv">10</span>), <span class="dt">lty =</span> <span class="dv">2</span>) </code></pre></div>
<p><img src="08-Discretas_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> Esta variable toma los valores 0 y 1/5 con probabilidad 2/10 = 1/5.
</div>
<p></p>
<ol style="list-style-type: lower-alpha">
<li>Diseña un algoritmo basándote en el método de inversión generalizado para generar observaciones de esta variable.</li>
</ol>
<p>El algoritmo general es siempre el mismo. Empleando la función cuantil: <span class="math display">\[Q\left( u\right) = \inf \left\{ x\in \mathbb{R}:F\left( x\right) 
\geq u\right\},\]</span> el algoritmo sería:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U\sim \mathcal{U}\left( 0,1\right)\)</span></p></li>
<li><p>Devolver <span class="math inline">\(X=Q\left( U\right)\)</span></p></li>
</ol>
<p>En este caso concreto:</p>
<ol style="list-style-type: decimal">
<li><p>Generar <span class="math inline">\(U\sim \mathcal{U}\left( 0,1\right)\)</span></p></li>
<li><p>Si <span class="math inline">\(U &lt; \frac{1}{10}\)</span> devolver <span class="math inline">\(X = 0\)</span></p></li>
<li><p>Si <span class="math inline">\(U &lt; \frac{2}{10}\)</span> devolver <span class="math inline">\(X = 2(U - \frac{1}{10})\)</span></p></li>
<li><p>Si <span class="math inline">\(U &lt; \frac{3}{10}\)</span> devolver <span class="math inline">\(X = \frac{2}{10}\)</span></p></li>
<li><p>En caso contrario devolver <span class="math inline">\(X = U - \frac{1}{10}\)</span></p></li>
</ol>
<ol start="2" style="list-style-type: lower-alpha">
<li>Implementa el algoritmo en una función que permita generar <span class="math inline">\(nsim\)</span> valores de la variable.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Función cuantil:</span>
fquant &lt;-<span class="st"> </span>function(u) {
<span class="kw">ifelse</span>(u &lt;<span class="st"> </span><span class="dv">1</span>/<span class="dv">10</span>, <span class="dv">0</span>,
     <span class="kw">ifelse</span>(u &lt;<span class="st"> </span><span class="dv">2</span>/<span class="dv">10</span>, <span class="dv">2</span>*(u -<span class="st"> </span><span class="dv">1</span>/<span class="dv">10</span>),
            <span class="kw">ifelse</span>(u &lt;<span class="st"> </span><span class="dv">3</span>/<span class="dv">10</span>, <span class="dv">2</span>/<span class="dv">10</span>, u -<span class="st"> </span><span class="dv">1</span>/<span class="dv">10</span>) ) )
}
<span class="co"># Función para generar nsim valores:</span>
rx &lt;-<span class="st"> </span>function(nsim) <span class="kw">fquant</span>(<span class="kw">runif</span>(nsim))</code></pre></div>
<p>Ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
nsim &lt;-<span class="st"> </span><span class="dv">10</span>^<span class="dv">4</span>
<span class="kw">system.time</span>(simx &lt;-<span class="st"> </span><span class="kw">rx</span>(nsim))</code></pre></div>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(simx, <span class="dt">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="08-Discretas_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>En este caso como no es una variable absolutamente continua mejor emplear la función de distribución para compararla con la teórica:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">ecdf</span>(simx)(x), <span class="dt">from=</span> -<span class="fl">0.1</span>, <span class="dt">to =</span> <span class="fl">1.1</span>, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)
<span class="kw">curve</span>(<span class="kw">fdistr</span>(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="08-Discretas_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>

<div class="exercise">
<span id="exr:unnamed-chunk-13" class="exercise"><strong>Ejercicio 7.3  </strong></span>fin de práctica
</div>
<p> Se pretende simular <span class="math inline">\(nsim=10^{4}\)</span> observaciones de una variable hipergeométrica (<code>dhyper(x, m, n, k)</code>) de parámetros <span class="math inline">\(m=\)</span> el nº de grupo multiplicado por 10, <span class="math inline">\(n=100-m\)</span> y <span class="math inline">\(k=20\)</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Comprobar que el rango de posibles valores de esta variable es <code>max(0, k-n):min(m, k)</code>. Generar los valores empleando el método de la transformación cuantil usando búsqueda secuencial. Obtener el tiempo de CPU empleado. Aproximar por simulación la función de masa de probabilidad, representarla gráficamente y compararla con la teórica. Calcular también la media muestral (compararla con la teórica <span class="math inline">\(km/(m+n)\)</span>) y el número medio de comparaciones para generar cada observación.</p></li>
<li><p>Repetir el apartado anterior ordenando previamente las probabilidades en orden decreciente y también: empleando la función <code>sample</code> de R, mediante una tabla guía (con <span class="math inline">\(k-1\)</span> subintervalos) y usando el método de Alias.</p></li>
</ol>
</div>
<div id="metodos-especificos-para-generacion-de-distribuciones-notables-1" class="section level2">
<h2><span class="header-section-number">8.2</span> Métodos específicos para generación de distribuciones notables</h2>
<p><strong><em>Pendiente: algunos ejemplos del libro de Ricardo y de las funciones implementadas en R</em></strong></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulacion-de-variables-continuas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulacion-de-distribuciones-multidimensionales.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-Discretas.Rmd",
"text": "Edit"
},
"download": ["Practicas_de_Simulacion.pdf", "Practicas_de_Simulacion.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
