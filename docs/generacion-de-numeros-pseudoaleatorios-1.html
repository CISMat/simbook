<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Prácticas de Simulación</title>
  <meta name="description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Prácticas de Simulación" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Prácticas de Simulación" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Simulación Estadística del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Rubén F. Casal (ruben.fcasal@udc.es)">


<meta name="date" content="2017-10-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="numeros-aleatorios-en-r.html">
<link rel="next" href="analisis-de-los-resultados.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Prácticas de Simulación</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html"><i class="fa fa-check"></i><b>1</b> Introducción a la simulación</a><ul>
<li class="chapter" data-level="1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#introduccion"><i class="fa fa-check"></i><b>1.1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#ventajas-de-la-simulacion-shannon-1975"><i class="fa fa-check"></i><b>1.1.1</b> Ventajas de la simulación (Shannon, 1975):</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes-de-la-simulacion"><i class="fa fa-check"></i><b>1.1.2</b> Inconvenientes de la simulación:</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.2</b> Generación de números (pseudo)aleatorios</a></li>
<li class="chapter" data-level="1.3" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-aleatorios-puros"><i class="fa fa-check"></i><b>1.3</b> Números aleatorios puros</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#inconvenientes"><i class="fa fa-check"></i><b>1.3.1</b> Inconvenientes:</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#alternativas"><i class="fa fa-check"></i><b>1.3.2</b> Alternativas:</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#numeros-pseudoaleatorios"><i class="fa fa-check"></i><b>1.4</b> Números pseudoaleatorios</a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduccion-a-la-simulacion.html"><a href="introduccion-a-la-simulacion.html#generacion-de-numeros-pseudoaleatorios-mediante-software"><i class="fa fa-check"></i><b>1.4.1</b> Generación de números pseudoaleatorios mediante software</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html"><i class="fa fa-check"></i><b>2</b> Números aleatorios en R</a><ul>
<li class="chapter" data-level="2.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#opciones"><i class="fa fa-check"></i><b>2.1</b> Opciones</a></li>
<li class="chapter" data-level="2.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r"><i class="fa fa-check"></i><b>2.2</b> Paquetes de R</a></li>
<li class="chapter" data-level="2.3" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#ejercicios"><i class="fa fa-check"></i><b>2.3</b> Ejercicios</a></li>
<li class="chapter" data-level="2.4" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4</b> Tiempo de CPU</a><ul>
<li class="chapter" data-level="2.4.1" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#utilidades-tiempo-de-cpu"><i class="fa fa-check"></i><b>2.4.1</b> Utilidades tiempo de CPU</a></li>
<li class="chapter" data-level="2.4.2" data-path="numeros-aleatorios-en-r.html"><a href="numeros-aleatorios-en-r.html#paquetes-de-r-1"><i class="fa fa-check"></i><b>2.4.2</b> Paquetes de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html"><i class="fa fa-check"></i><b>3</b> Generación de números pseudoaleatorios</a><ul>
<li class="chapter" data-level="3.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generadores-congruenciales"><i class="fa fa-check"></i><b>3.1</b> Generadores congruenciales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#generador-congruencial-lineal-simple"><i class="fa fa-check"></i><b>3.1.1</b> Generador congruencial lineal (simple)</a></li>
<li class="chapter" data-level="3.1.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#periodo"><i class="fa fa-check"></i><b>3.1.2</b> Periodo</a></li>
<li class="chapter" data-level="3.1.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#otros-generadores"><i class="fa fa-check"></i><b>3.1.3</b> Otros generadores</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#analisis-de-la-calidad-de-un-generador"><i class="fa fa-check"></i><b>3.2</b> Análisis de la calidad de un generador</a><ul>
<li class="chapter" data-level="3.2.1" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#repeticion-de-contrastes"><i class="fa fa-check"></i><b>3.2.1</b> Repetición de contrastes</a></li>
<li class="chapter" data-level="3.2.2" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#baterias-de-contrastes"><i class="fa fa-check"></i><b>3.2.2</b> Baterías de contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="generacion-de-numeros-pseudoaleatorios-1.html"><a href="generacion-de-numeros-pseudoaleatorios-1.html#ejercicios-de-fin-de-practica"><i class="fa fa-check"></i><b>3.3</b> Ejercicios de fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html"><i class="fa fa-check"></i><b>4</b> Análisis de los resultados</a><ul>
<li class="chapter" data-level="4.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#convergencia"><i class="fa fa-check"></i><b>4.1</b> Convergencia</a></li>
<li class="chapter" data-level="4.2" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#estimacion-de-la-precision"><i class="fa fa-check"></i><b>4.2</b> Estimación de la precisión</a></li>
<li class="chapter" data-level="4.3" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#teorema-central-del-limite"><i class="fa fa-check"></i><b>4.3</b> Teorema central del límite</a></li>
<li class="chapter" data-level="4.4" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#determinacion-del-numero-de-generaciones"><i class="fa fa-check"></i><b>4.4</b> Determinación del número de generaciones</a></li>
<li class="chapter" data-level="4.5" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#el-problema-de-la-dependencia"><i class="fa fa-check"></i><b>4.5</b> El problema de la dependencia:</a><ul>
<li class="chapter" data-level="4.5.1" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#periodo-de-calentamiento"><i class="fa fa-check"></i><b>4.5.1</b> Periodo de calentamiento</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="analisis-de-los-resultados.html"><a href="analisis-de-los-resultados.html#observaciones"><i class="fa fa-check"></i><b>4.6</b> Observaciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><i class="fa fa-check"></i><b>5</b> Aplicaciones de la simulación en Inferencia Estadística</a><ul>
<li class="chapter" data-level="5.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#aplicaciones-de-la-simulacion"><i class="fa fa-check"></i><b>5.1</b> Aplicaciones de la simulación</a></li>
<li class="chapter" data-level="5.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#distribucion-en-el-muestreo"><i class="fa fa-check"></i><b>5.2</b> Distribución en el muestreo</a></li>
<li class="chapter" data-level="5.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>5.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="5.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#contrastes-de-hipotesis"><i class="fa fa-check"></i><b>5.4</b> Contrastes de hipótesis</a></li>
<li class="chapter" data-level="5.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#comparacion-de-estimadores"><i class="fa fa-check"></i><b>5.5</b> Comparación de estimadores</a></li>
<li class="chapter" data-level="5.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6</b> Remuestreo Bootstrap</a><ul>
<li class="chapter" data-level="5.6.1" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#idea"><i class="fa fa-check"></i><b>5.6.1</b> Idea:</a></li>
<li class="chapter" data-level="5.6.2" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#metodos-de-remuestreo-bootstrap"><i class="fa fa-check"></i><b>5.6.2</b> Métodos de remuestreo Bootstrap</a></li>
<li class="chapter" data-level="5.6.3" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#ejemplo"><i class="fa fa-check"></i><b>5.6.3</b> Ejemplo</a></li>
<li class="chapter" data-level="5.6.4" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#paquetes-r-bootstrap-boot"><i class="fa fa-check"></i><b>5.6.4</b> Paquetes R: bootstrap, boot</a></li>
<li class="chapter" data-level="5.6.5" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#graficos"><i class="fa fa-check"></i><b>5.6.5</b> Gráficos</a></li>
<li class="chapter" data-level="5.6.6" data-path="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html"><a href="aplicaciones-de-la-simulacion-en-inferencia-estadistica.html#intervalos-de-confianza-bootstrap"><i class="fa fa-check"></i><b>5.6.6</b> Intervalos de confianza bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html"><i class="fa fa-check"></i><b>6</b> Integración y Optimización Montecarlo</a><ul>
<li class="chapter" data-level="6.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#integracion-monte-carlo-clasica"><i class="fa fa-check"></i><b>6.1</b> Integración Monte Carlo (clásica)</a></li>
<li class="chapter" data-level="6.2" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2</b> Muestreo por importancia</a><ul>
<li class="chapter" data-level="6.2.1" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#remuestreo-del-muestreo-por-importancia"><i class="fa fa-check"></i><b>6.2.1</b> Remuestreo (del muestreo) por importancia</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#optimizacion-monte-carlo"><i class="fa fa-check"></i><b>6.3</b> Optimización Monte Carlo</a></li>
<li class="chapter" data-level="6.4" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#temple-simulado"><i class="fa fa-check"></i><b>6.4</b> Temple simulado</a></li>
<li class="chapter" data-level="6.5" data-path="integracion-y-optimizacion-montecarlo.html"><a href="integracion-y-optimizacion-montecarlo.html#algoritmos-geneticos"><i class="fa fa-check"></i><b>6.5</b> Algoritmos genéticos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html"><i class="fa fa-check"></i><b>7</b> Simulación de variables continuas</a><ul>
<li class="chapter" data-level="7.1" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-inversion"><i class="fa fa-check"></i><b>7.1</b> Método de inversión</a></li>
<li class="chapter" data-level="7.2" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodo-de-aceptacion-rechazo"><i class="fa fa-check"></i><b>7.2</b> Método de aceptación-rechazo</a></li>
<li class="chapter" data-level="7.3" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#ejercicios-1"><i class="fa fa-check"></i><b>7.3</b> Ejercicios</a></li>
<li class="chapter" data-level="7.4" data-path="simulacion-de-variables-continuas.html"><a href="simulacion-de-variables-continuas.html#metodos-especificos-para-generacion-de-distribuciones-notables"><i class="fa fa-check"></i><b>7.4</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html"><i class="fa fa-check"></i><b>8</b> Simulación de variables discretas</a><ul>
<li class="chapter" data-level="8.1" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#ejercicios-2"><i class="fa fa-check"></i><b>8.1</b> Ejercicios</a></li>
<li class="chapter" data-level="8.2" data-path="simulacion-de-variables-discretas.html"><a href="simulacion-de-variables-discretas.html#metodos-especificos-para-generacion-de-distribuciones-notables-1"><i class="fa fa-check"></i><b>8.2</b> Métodos específicos para generación de distribuciones notables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html"><i class="fa fa-check"></i><b>9</b> Simulación de Distribuciones Multidimensionales</a><ul>
<li class="chapter" data-level="9.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#introduccion-1"><i class="fa fa-check"></i><b>9.1</b> Introducción</a></li>
<li class="chapter" data-level="9.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#factorizacion-de-la-matriz-de-covarianzas"><i class="fa fa-check"></i><b>9.2</b> Factorización de la matriz de covarianzas</a></li>
<li class="chapter" data-level="9.3" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-condicional-e-incondicional"><i class="fa fa-check"></i><b>9.3</b> Simulación condicional e incondicional</a></li>
<li class="chapter" data-level="9.4" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-basada-en-copulas"><i class="fa fa-check"></i><b>9.4</b> Simulación basada en cópulas</a></li>
<li class="chapter" data-level="9.5" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-distribuciones-multidimensionales-discretas"><i class="fa fa-check"></i><b>9.5</b> Simulación de distribuciones multidimensionales discretas</a><ul>
<li class="chapter" data-level="9.5.1" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-una-variable-discreta-bidimensional"><i class="fa fa-check"></i><b>9.5.1</b> Simulación de una variable discreta bidimensional</a></li>
<li class="chapter" data-level="9.5.2" data-path="simulacion-de-distribuciones-multidimensionales.html"><a href="simulacion-de-distribuciones-multidimensionales.html#simulacion-de-tablas-de-contingencia"><i class="fa fa-check"></i><b>9.5.2</b> Simulación de tablas de contingencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html"><i class="fa fa-check"></i><b>10</b> Técnicas de reducción de la varianza</a><ul>
<li class="chapter" data-level="10.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#reduccion-de-la-varianza"><i class="fa fa-check"></i><b>10.1</b> Reducción de la varianza</a></li>
<li class="chapter" data-level="10.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-antiteticas"><i class="fa fa-check"></i><b>10.2</b> Variables antitéticas</a><ul>
<li class="chapter" data-level="10.2.1" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejemplo-integracion-monte-carlo"><i class="fa fa-check"></i><b>10.2.1</b> Ejemplo: Integración Monte Carlo</a></li>
<li class="chapter" data-level="10.2.2" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#generacion-de-variables-antiteticas"><i class="fa fa-check"></i><b>10.2.2</b> Generación de variables antitéticas</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#estratificacion"><i class="fa fa-check"></i><b>10.3</b> Estratificación</a></li>
<li class="chapter" data-level="10.4" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#variables-de-control"><i class="fa fa-check"></i><b>10.4</b> Variables de control</a></li>
<li class="chapter" data-level="10.5" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#numeros-aleatorios-comunes"><i class="fa fa-check"></i><b>10.5</b> Números aleatorios comunes</a></li>
<li class="chapter" data-level="10.6" data-path="tecnicas-de-reduccion-de-la-varianza.html"><a href="tecnicas-de-reduccion-de-la-varianza.html#ejercicios-fin-de-practica"><i class="fa fa-check"></i><b>10.6</b> Ejercicios fin de práctica</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pendiente-ejercicios-bookdown.html"><a href="pendiente-ejercicios-bookdown.html"><i class="fa fa-check"></i><b>11</b> Pendiente (ejercicios bookdown)</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a><ul>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-basica"><i class="fa fa-check"></i>Bibliografía básica</a></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html#bibliografia-complementaria"><i class="fa fa-check"></i>Bibliografía complementaria</a></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html"><i class="fa fa-check"></i><b>A</b> Recursos para el aprendizaje de R</a><ul>
<li class="chapter" data-level="A.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#cursos"><i class="fa fa-check"></i><b>A.1</b> Cursos</a></li>
<li class="chapter" data-level="A.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#libros"><i class="fa fa-check"></i><b>A.2</b> Libros</a><ul>
<li class="chapter" data-level="A.2.1" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#iniciacion"><i class="fa fa-check"></i><b>A.2.1</b> Iniciación</a></li>
<li class="chapter" data-level="A.2.2" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#avanzados"><i class="fa fa-check"></i><b>A.2.2</b> Avanzados</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#material"><i class="fa fa-check"></i><b>A.3</b> Material</a></li>
<li class="chapter" data-level="A.4" data-path="recursos-para-el-aprendizaje-de-r.html"><a href="recursos-para-el-aprendizaje-de-r.html#ayuda"><i class="fa fa-check"></i><b>A.4</b> Ayuda</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="integracion-numerica.html"><a href="integracion-numerica.html"><i class="fa fa-check"></i><b>B</b> Integración numérica</a><ul>
<li class="chapter" data-level="B.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#introduccion-2"><i class="fa fa-check"></i><b>B.1</b> Introducción</a></li>
<li class="chapter" data-level="B.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-unidimensional"><i class="fa fa-check"></i><b>B.2</b> Integración numérica unidimensional</a><ul>
<li class="chapter" data-level="B.2.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide"><i class="fa fa-check"></i><b>B.2.1</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.2.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#regla-de-simpson"><i class="fa fa-check"></i><b>B.2.2</b> Regla de Simpson</a></li>
<li class="chapter" data-level="B.2.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#cuadratura-adaptativa"><i class="fa fa-check"></i><b>B.2.3</b> Cuadratura adaptativa</a></li>
<li class="chapter" data-level="B.2.4" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-de-r"><i class="fa fa-check"></i><b>B.2.4</b> Comandos de <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#integracion-numerica-bidimensional"><i class="fa fa-check"></i><b>B.3</b> Integración numérica bidimensional</a><ul>
<li class="chapter" data-level="B.3.1" data-path="integracion-numerica.html"><a href="integracion-numerica.html#representacion-grafica"><i class="fa fa-check"></i><b>B.3.1</b> Representación gráfica</a></li>
<li class="chapter" data-level="B.3.2" data-path="integracion-numerica.html"><a href="integracion-numerica.html#metodo-del-trapezoide-1"><i class="fa fa-check"></i><b>B.3.2</b> Método del trapezoide</a></li>
<li class="chapter" data-level="B.3.3" data-path="integracion-numerica.html"><a href="integracion-numerica.html#comandos-r"><i class="fa fa-check"></i><b>B.3.3</b> Comandos R</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Simulación</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generacion-de-numeros-pseudoaleatorios-1" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Generación de números pseudoaleatorios</h1>
<div id="generadores-congruenciales" class="section level2">
<h2><span class="header-section-number">3.1</span> Generadores congruenciales</h2>
<div id="generador-congruencial-lineal-simple" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Generador congruencial lineal (simple)</h3>
<p>Partiendo de una semilla inicial <span class="math inline">\(x_{0}\)</span>: <span class="math display">\[\begin{aligned}
x_{i}  &amp; =(ax_{i-1}+c)\operatorname{mod}m\\
u_{i}  &amp; =\dfrac{x_{i}}{m}\\
i  &amp; =1,2,\ldots
\end{aligned}\]</span> donde <span class="math inline">\(a\)</span> es el <strong>multiplicador,</strong> <span class="math inline">\(c\)</span> el <strong>incremento</strong> y <span class="math inline">\(m\)</span> el <strong>módulo</strong> del generador (parámetros enteros fijados de antemano).</p>
<ul>
<li><p>Si <span class="math inline">\(c=0\)</span> se denomina congruencial <strong>multiplicativo</strong></p></li>
<li><p>Si <span class="math inline">\(c\neq0\)</span> se denomina congruencial <strong>mixto</strong></p></li>
</ul>
<p>Implementado en el fichero <em>RANDC.R</em> (tratando de imitar el funcionamiento en R, aunque de forma no muy eficiente…):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generador congruencial de números pseudoaleatorios</span>
<span class="co"># ==================================================</span>

<span class="co"># --------------------------------------------------</span>
<span class="co"># initRANDC(semilla,a,c,m)</span>
<span class="co">#   Selecciona el generador congruencial</span>
<span class="co">#   Por defecto RANDU de IBM con semilla del reloj</span>
<span class="co">#   OJO: No se hace ninguna verificación de los parámetros</span>
initRANDC &lt;-<span class="st"> </span>function(<span class="dt">semilla=</span><span class="kw">as.numeric</span>(<span class="kw">Sys.time</span>()), <span class="dt">a=</span><span class="dv">2</span>^<span class="dv">16+3</span>, <span class="dt">c=</span><span class="dv">0</span>, <span class="dt">m=</span><span class="dv">2</span>^<span class="dv">31</span>) {
  .semilla &lt;&lt;-<span class="st"> </span><span class="kw">as.double</span>(semilla) %%<span class="st"> </span>m  <span class="co">#Cálculos en doble precisión</span>
  .a &lt;&lt;-<span class="st"> </span>a
  .c &lt;&lt;-<span class="st"> </span>c
  .m &lt;&lt;-<span class="st"> </span>m
  <span class="kw">return</span>(<span class="kw">invisible</span>(<span class="kw">list</span>(<span class="dt">semilla=</span>.semilla,<span class="dt">a=</span>.a,<span class="dt">c=</span>.c,<span class="dt">m=</span>.m))) <span class="co">#print(initRANDC())</span>
}

<span class="co"># --------------------------------------------------</span>
<span class="co"># RANDC()</span>
<span class="co">#   Genera un valor pseudoaleatorio con el generador congruencial</span>
<span class="co">#   Actualiza la semilla (si no existe llama a initRANDC)</span>
RANDC &lt;-<span class="st"> </span>function() {
    if (!<span class="kw">exists</span>(<span class="st">&quot;.semilla&quot;</span>, <span class="dt">envir=</span><span class="kw">globalenv</span>())) <span class="kw">initRANDC</span>()
    .semilla &lt;&lt;-<span class="st"> </span>(.a *<span class="st"> </span>.semilla +<span class="st"> </span>.c) %%<span class="st"> </span>.m
    <span class="kw">return</span>(.semilla/.m)
}

<span class="co"># --------------------------------------------------</span>
<span class="co"># RANDCN(n)</span>
<span class="co">#   Genera un vector de valores pseudoaleatorios con el generador congruencial</span>
<span class="co">#   (por defecto de dimensión 1000)</span>
<span class="co">#   Actualiza la semilla (si no existe llama a initRANDC)</span>
RANDCN &lt;-<span class="st"> </span>function(<span class="dt">n=</span><span class="dv">1000</span>) {
    x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
    for(i in <span class="dv">1</span>:n) x[i]&lt;-<span class="kw">RANDC</span>()
    <span class="kw">return</span>(x)
    <span class="co"># return(replicate(n,RANDC()))  # Alternativa más rápida    </span>
}

<span class="kw">initRANDC</span>(<span class="dv">543210</span>)       <span class="co"># Fijar semilla 543210 para reproductibilidad</span></code></pre></div>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> Para evitar problemas computacionales, se recomienda emplear un algoritmo como el descrito en L’Ecuyer (1988).
</div>
<p></p>
<p>Ejemplos:</p>
<ul>
<li><p><span class="math inline">\(c=0\)</span>, <span class="math inline">\(a=2^{16}+3=65539\)</span> y <span class="math inline">\(m=2^{31}\)</span>, generador <code>RANDU</code> de IBM (<strong>no recomendable</strong>).</p></li>
<li><p><span class="math inline">\(c=0\)</span>, <span class="math inline">\(a=7^{5}=16807\)</span> y <span class="math inline">\(m=2^{31}-1,\)</span> Park y Miller (1988) “minimal standar”,empleado por las librerías IMSL y NAG.</p></li>
</ul>
<p>Los parámetros y la semilla determinan los valores generados: <span class="math display">\[x_{i}=\left(  a^{i}x_{0}+c\frac{a^{i}-1}{a-1}\right)  \operatorname{mod}m\]</span></p>
<p>A pesar de su simplicidad, una adecuada elección de los parámetros permite obtener de manera eficiente secuencias de números “aparentemente” i.i.d. <span class="math inline">\(\mathcal{U}(0,1).\)</span></p>
</div>
<div id="periodo" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Periodo</h3>

<div class="theorem">
<p><span id="thm:unnamed-chunk-3" class="theorem"><strong>Teorema 3.1  </strong></span>(Hull y Dobell, 1962)</p>
<p>Un generador congruencial tiene período máximo (<span class="math inline">\(p=m\)</span>) si y solo si:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(c\)</span> y <span class="math inline">\(m\)</span> son primos relativos (i.e. <span class="math inline">\(m.c.d.\left( c,m\right) =1\)</span>).</p></li>
<li><p><span class="math inline">\(a-1\)</span> es múltiplo de todos los factores primos de <span class="math inline">\(m\)</span> (i.e. <span class="math inline">\(a\equiv1\operatorname{mod}q\)</span>, para todo <span class="math inline">\(q\)</span> factor primo de <span class="math inline">\(m\)</span>).</p></li>
<li><p>Si <span class="math inline">\(m\)</span> es múltiplo de <span class="math inline">\(4\)</span>, entonces <span class="math inline">\(a-1\)</span> también lo ha de ser (i.e. <span class="math inline">\(m\equiv0\operatorname{mod}4\Rightarrow a\equiv 1\operatorname{mod}4\)</span>).</p></li>
</ol>
.
</div>
<p></p>
<p>Algunas consecuencias:</p>
<ul>
<li><p>Si <span class="math inline">\(m\)</span> primo, <span class="math inline">\(p=m\Leftrightarrow a=1\)</span></p></li>
<li><p>Un generador multiplicativo no cumple la condición 1.</p></li>
</ul>

<div class="theorem">
<p><span id="thm:unnamed-chunk-4" class="theorem"><strong>Teorema 3.2  </strong></span> Un generador multiplicativo tiene período máximo (<span class="math inline">\(p=m-1\)</span>) si:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(m\)</span> es primo.</p></li>
<li><p><span class="math inline">\(a\)</span> es una raiz primitiva de <span class="math inline">\(m\)</span>(i.e. el menor entero <span class="math inline">\(q\)</span> tal que <span class="math inline">\(a^{q}=1\operatorname{mod}m\)</span> es <span class="math inline">\(q=m-1\)</span>).</p></li>
</ol>
.
</div>
<p></p>
<p>Además de preocuparse de la longitud del ciclo, las secuencias generadas deben aparentar muestras i.i.d. <span class="math inline">\(\mathcal{U}(0,1)\)</span>. Por ejemplo, los valores generados pueden mostrar una estructura reticular.</p>
<ul>
<li><p>Marsaglia (1968): <span class="math inline">\(k\)</span>-uplas de generadores multiplicativos contenidas en a lo sumo <span class="math inline">\(\left(k!m\right)^{1/k}\)</span> hiperplanos paralelos.</p></li>
<li><p>Generador RANDU de IBM (70’s):</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rgl)
<span class="kw">system.time</span>(u &lt;-<span class="st"> </span><span class="kw">RANDCN</span>(<span class="dv">9999</span>))  <span class="co"># Generar</span>
xyz &lt;-<span class="st"> </span><span class="kw">matrix</span>(u, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)

<span class="kw">plot3d</span>(xyz) 
<span class="co"># rglwidget()</span></code></pre></div>
<p><img src="images/randu2.png" style="display: block; margin: auto;" /></p>
<p>Se han propuesto diversas pruebas (ver sección siguiente) para determinar si un generador tiene problemas de este tipo y se han realizado numerosos estudios para determinadas familias (e.g. Park y Miller, 1988, <span class="math inline">\(m=2^{31}-1\)</span>).</p>
<ul>
<li><p>En cualquier caso, se recomienda considerar un “periodo de seguridad” <span class="math inline">\(\approx \sqrt{p}\)</span> para evitar este tipo de problemas.</p></li>
<li><p>Aunque estos generadores tiene limitaciones en su capacidad para producir secuencias muy largas de números i.i.d. <span class="math inline">\(\mathcal{U}(0,1)\)</span>, es un elemento básico en generadores más avanzados.</p></li>
</ul>
</div>
<div id="otros-generadores" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Otros generadores</h3>
<p>Generalizaciones del generador congruencial lineal simple: <span class="math display">\[x_{i}=f\left(  x_{i-1},x_{i-2},\cdots,x_{i-k}\right)  \operatorname{mod}m\]</span></p>
<ul>
<li><p>no lineal: e.g. <span class="math inline">\(\ x_{i}=a_{1}x_{i-1}+a_{2}x_{i-1}^{2}\operatorname{mod}m\)</span></p></li>
<li><p>lineal múltiple: <span class="math inline">\(x_{i}=a_{1}x_{i-1}+a_{2}x_{i-2}+\cdots+a_{k}x_{i-k}\operatorname{mod}m\)</span>, con <span class="math inline">\(p\leq m^{k}-1\)</span>)</p></li>
<li><p>matricial: <span class="math inline">\(\boldsymbol{x}_{i} = A_{1}\boldsymbol{x}_{i-1} + A_{2}\boldsymbol{x}_{i-2} + \cdots + A_{k}\boldsymbol{x}_{i-k} \operatorname{mod}m\)</span> (por ejemplo el generador por defecto de <code>R</code>).</p></li>
<li><p>Generadores de registros desfasados: generadores de bits basados en el lineal múltiple <span class="math inline">\(m=2\)</span>; <span class="math inline">\(a_{i},x_{i}\in \left \{ 0,1\right \}\)</span> (cálculos mediante operaciones lógicas).</p></li>
<li><p>Combinación de generadores:</p>
<ul>
<li><p>Combinación de salidas: <span class="math inline">\(u_{i}=\sum u_{i}^{(l)}\operatorname{mod}1\)</span></p></li>
<li><p>Barajar salidas…</p></li>
</ul></li>
</ul>

<div class="exercise">
<span id="exr:unnamed-chunk-7" class="exercise"><strong>Ejercicio 2.2  </strong></span>
</div>
<p></p>
<p>Considera el generador congruencial definido por: <span class="math display">\[\begin{aligned}
x_{n+1}  &amp; =(5x_{n}+1)\ \operatorname{mod}\ 512,\nonumber\\
u_{n+1}  &amp; =\frac{x_{n+1}}{512},\ n=0,1,\dots\nonumber\end{aligned}\]</span></p>
<p>(de ciclo máximo).</p>
<p>Algoritmo implementado en el fichero <em>RANDC.R</em>:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Generar 500 valores de este generador, obtener el tiempo de CPU, representar su distribución mediante un histograma (en escala de densidades) y compararla con la densidad teórica.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">initRANDC</span>(<span class="dv">321</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">512</span>)       <span class="co"># Fijar semilla para reproductibilidad</span>
nsim &lt;-<span class="st"> </span><span class="dv">500</span>
<span class="kw">system.time</span>(u &lt;-<span class="st"> </span><span class="kw">RANDCN</span>(nsim))  <span class="co"># Generar</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.02    0.00    0.02</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(u, <span class="dt">freq =</span> <span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span>)                   <span class="co"># curve(dunif(x, 0, 1), add = TRUE)</span></code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p></li>
<li><p>Calcular la media de las simulaciones (<code>mean</code>) y compararla con la teórica.</p>
<p>La aproximación por simulación de la media teórica es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(u)</code></pre></div>
<pre><code>## [1] 0.4999609</code></pre>
<p>La media teórica es 0.5. Error absoluto <span class="math inline">\(3.90625\times 10^{-5}\)</span>.</p></li>
<li><p>Aproximar (mediante simulación) la probabilidad del intervalo <span class="math inline">\((0.4;0.8)\)</span> y compararla con la teórica.</p>
<p>La probabilidad teórica es 0.8 - 0.4 = 0.4</p>
<p>La aproximación mediante simulación:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>((<span class="fl">0.4</span> &lt;<span class="st"> </span>u) &amp;<span class="st"> </span>(u &lt;<span class="st"> </span><span class="fl">0.8</span>))/nsim</code></pre></div>
<pre><code>## [1] 0.402</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((<span class="fl">0.4</span> &lt;<span class="st"> </span>u) &amp;<span class="st"> </span>(u &lt;<span class="st"> </span><span class="fl">0.8</span>))     <span class="co"># Alternativa</span></code></pre></div>
<pre><code>## [1] 0.402</code></pre></li>
</ol>
</div>
</div>
<div id="analisis-de-la-calidad-de-un-generador" class="section level2">
<h2><span class="header-section-number">3.2</span> Análisis de la calidad de un generador</h2>
<p>Para verificar si un generador tiene las propiedades estadísticas deseadas hay disponibles una gran cantidad de test de hipótesis (baterías de contrastes) y métodos gráficos:</p>
<ul>
<li><p>Contrastes genéricos de bondad de ajuste y aleatoriedad.</p></li>
<li><p>Contrastes específicos para generadores aleatorios.</p></li>
</ul>
<p>Se trata principalmente de contrastar si las muestras generadas son i.i.d. <span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span> (análisis univariante). Aunque los métodos más avanzados tratan normalmente de contrastar si las <span class="math inline">\(k\)</span>-uplas:</p>
<p><span class="math display">\[(U_{t+1},U_{t+2},...,U_{t+k-1}); \ t=(i-1)k, \ i=1,...,m\]</span></p>
<p>son i.i.d. <span class="math inline">\(\mathcal{U}\left(0,1\right)^{k}\)</span> (uniformes independientes en el hipercubo; análisis multivariante).</p>
<p><strong>Nos centraremos en los métodos genéricos</strong>. Pueden usarse en:</p>
<ul>
<li><p>Evaluación de generadores aleatorios</p></li>
<li><p>Evaluación de generadores de variables aleatorias</p></li>
<li><p>Modelado de entradas de modelos de simulación</p></li>
</ul>
<p>Uno de los contrastes más conocidos es el test ji-cuadrado de bondad de ajuste (<code>chisq.test</code> para el caso discreto). Aunque si la variable de interés es continua, habría que discretizarla (con la correspondiente perdida de información). Por ejemplo, se podría emplear la siguiente función (que imita a las incluídas en <code>R</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#-------------------------------------------------------------------------------</span>
<span class="co"># chisq.test.cont(x, distribution, nclasses, output, nestpar,...)</span>
<span class="co">#-------------------------------------------------------------------------------</span>
<span class="co"># Realiza el test ji-cuadrado de bondad de ajuste para una distribución continua</span>
<span class="co"># discretizando en intervalos equiprobables.</span>
<span class="co"># Parámetros:</span>
<span class="co">#   distribution = &quot;norm&quot;,&quot;unif&quot;,etc</span>
<span class="co">#   nclasses = floor(length(x)/5)</span>
<span class="co">#   output = TRUE</span>
<span class="co">#   nestpar = 0= nº de parámetros estimados</span>
<span class="co">#   ... = parámetros distribución</span>
<span class="co"># Ejemplo:</span>
<span class="co">#   chisq.test.cont(x, distribution=&quot;norm&quot;, nestpar=2, mean=mean(x), sd=sqrt((nx-1)/nx)*sd(x))</span>
<span class="co">#-------------------------------------------------------------------------------</span>
chisq.test.cont &lt;-<span class="st"> </span>function(x, <span class="dt">distribution =</span> <span class="st">&quot;norm&quot;</span>, <span class="dt">nclasses =</span> <span class="kw">floor</span>(<span class="kw">length</span>(x)/<span class="dv">5</span>), 
    <span class="dt">output =</span> <span class="ot">TRUE</span>, <span class="dt">nestpar =</span> <span class="dv">0</span>, ...) {
    <span class="co"># Funciones distribución</span>
    q.distrib &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">paste</span>(<span class="st">&quot;q&quot;</span>, distribution, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)))
    d.distrib &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">paste</span>(<span class="st">&quot;d&quot;</span>, distribution, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)))
    <span class="co"># Puntos de corte</span>
    q &lt;-<span class="st"> </span><span class="kw">q.distrib</span>((<span class="dv">1</span>:(nclasses -<span class="st"> </span><span class="dv">1</span>))/nclasses, ...)
    tol &lt;-<span class="st"> </span><span class="kw">sqrt</span>(.Machine$double.eps)
    xbreaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(x) -<span class="st"> </span>tol, q, <span class="kw">max</span>(x) +<span class="st"> </span>tol)
    <span class="co"># Gráficos y frecuencias</span>
    if (output) {
        xhist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> xbreaks, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">border =</span> <span class="st">&quot;grey50&quot;</span>)
        <span class="kw">curve</span>(<span class="kw">d.distrib</span>(x, ...), <span class="dt">add =</span> <span class="ot">TRUE</span>)
    } else {
        xhist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> xbreaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
    }
    <span class="co"># Cálculo estadístico y p-valor</span>
    O &lt;-<span class="st"> </span>xhist$counts  <span class="co"># Equivalente a table(cut(x, xbreaks)) pero más eficiente</span>
    E &lt;-<span class="st"> </span><span class="kw">length</span>(x)/nclasses
    DNAME &lt;-<span class="st"> </span><span class="kw">deparse</span>(<span class="kw">substitute</span>(x))
    METHOD &lt;-<span class="st"> &quot;Pearson&#39;s Chi-squared test&quot;</span>
    STATISTIC &lt;-<span class="st"> </span><span class="kw">sum</span>((O -<span class="st"> </span>E)^<span class="dv">2</span>/E)
    <span class="kw">names</span>(STATISTIC) &lt;-<span class="st"> &quot;X-squared&quot;</span>
    PARAMETER &lt;-<span class="st"> </span>nclasses -<span class="st"> </span>nestpar -<span class="st"> </span><span class="dv">1</span>
    <span class="kw">names</span>(PARAMETER) &lt;-<span class="st"> &quot;df&quot;</span>
    PVAL &lt;-<span class="st"> </span><span class="kw">pchisq</span>(STATISTIC, PARAMETER, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
    <span class="co"># Preparar resultados</span>
    classes &lt;-<span class="st"> </span><span class="kw">format</span>(xbreaks)
    classes &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;(&quot;</span>, classes[-(nclasses +<span class="st"> </span><span class="dv">1</span>)], <span class="st">&quot;,&quot;</span>, classes[-<span class="dv">1</span>], <span class="st">&quot;]&quot;</span>, 
        <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)
    RESULTS &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">classes =</span> classes, <span class="dt">observed =</span> O, <span class="dt">expected =</span> E, <span class="dt">residuals =</span> (O -<span class="st"> </span>
<span class="st">        </span>E)/<span class="kw">sqrt</span>(E))
    if (output) {
        <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Pearson&#39;s Chi-squared test table</span><span class="ch">\n</span><span class="st">&quot;</span>)
        <span class="kw">print</span>(<span class="kw">as.data.frame</span>(RESULTS))
    }
    if (<span class="kw">any</span>(E &lt;<span class="st"> </span><span class="dv">5</span>)) 
        <span class="kw">warning</span>(<span class="st">&quot;Chi-squared approximation may be incorrect&quot;</span>)
    <span class="kw">structure</span>(<span class="kw">c</span>(<span class="kw">list</span>(<span class="dt">statistic =</span> STATISTIC, <span class="dt">parameter =</span> PARAMETER, <span class="dt">p.value =</span> PVAL, 
        <span class="dt">method =</span> METHOD, <span class="dt">data.name =</span> DNAME), RESULTS), <span class="dt">class =</span> <span class="st">&quot;htest&quot;</span>)
}</code></pre></div>
<p>Por ejemplo, continuando con el generador congruencial anterior, obtendríamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test.cont</span>(u, <span class="dt">distribution =</span> <span class="st">&quot;unif&quot;</span>, 
                <span class="dt">nclasses =</span> <span class="dv">10</span>, <span class="dt">nestpar =</span> <span class="dv">0</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre><code>## 
## Pearson&#39;s Chi-squared test table
##                          classes observed expected  residuals
## 1  (-1.490116e-08, 1.000000e-01]       51       50  0.1414214
## 2  ( 1.000000e-01, 2.000000e-01]       49       50 -0.1414214
## 3  ( 2.000000e-01, 3.000000e-01]       49       50 -0.1414214
## 4  ( 3.000000e-01, 4.000000e-01]       50       50  0.0000000
## 5  ( 4.000000e-01, 5.000000e-01]       51       50  0.1414214
## 6  ( 5.000000e-01, 6.000000e-01]       51       50  0.1414214
## 7  ( 6.000000e-01, 7.000000e-01]       49       50 -0.1414214
## 8  ( 7.000000e-01, 8.000000e-01]       50       50  0.0000000
## 9  ( 8.000000e-01, 9.000000e-01]       50       50  0.0000000
## 10 ( 9.000000e-01, 9.980469e-01]       50       50  0.0000000</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  u
## X-squared = 0.12, df = 9, p-value = 1</code></pre>
<p><strong>Importante</strong>: Empleando los métodos genéricos del modo habitual, desconfiamos del generador si la muestra/secuencia no se ajusta a la distribución teórica (<em>p</em>-valor <span class="math inline">\(\leq \alpha\)</span>). En este caso además, <strong>también se sospecha si se ajusta demasiado bien</strong> a la distribución teórica (<em>p</em>-valor <span class="math inline">\(\geq1-\alpha\)</span>).</p>
<p>Otro contraste de bondad de ajuste muy conocido es el test de Kolmogorov-Smirnov, implementado en <code>ks.test</code>.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-14" class="exercise"><strong>Ejercicio 2.4  </strong></span>
</div>
<p></p>
<p>Continuando con el generador congruencial anterior:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">initRANDC</span>(<span class="dv">321</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">512</span>)       <span class="co"># Fijar semilla para reproductibilidad</span>
nsim &lt;-<span class="st"> </span><span class="dv">500</span>
<span class="kw">system.time</span>(u &lt;-<span class="st"> </span><span class="kw">RANDCN</span>(nsim))  <span class="co"># Generar</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Realizar el contraste de Kolmogorov-Smirnov para estudiar el ajuste a una <span class="math inline">\(\mathcal{U}(0,1)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribución empírica</span>
<span class="kw">curve</span>(<span class="kw">ecdf</span>(u)(x), <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">curve</span>(<span class="kw">punif</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test de Kolmogorov-Smirnov</span>
<span class="kw">ks.test</span>(u, <span class="st">&quot;punif&quot;</span>, <span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  u
## D = 0.0033281, p-value = 1
## alternative hypothesis: two-sided</code></pre></li>
<li><p>Obtener el gráfico secuencial y el de dispersión retardado, ¿se observa algún problema?</p>
<p>Gráfico secuencial:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">as.ts</span>(u))</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Gráfico de dispersión retardado:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(u[-nsim],u[-<span class="dv">1</span>])</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p></li>
<li><p>Estudiar las correlaciones del vector <span class="math inline">\((u_{i},u_{i+k})\)</span>, con <span class="math inline">\(k=1,...,10\)</span>. Contrastar si son nulas.</p>
<p>Correlaciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(u)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Test de Ljung-Box:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Box.test</span>(u, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="dt">type =</span> <span class="st">&quot;Ljung&quot;</span>)</code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  u
## X-squared = 22.533, df = 10, p-value = 0.01261</code></pre></li>
</ol>
<div id="repeticion-de-contrastes" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Repetición de contrastes</h3>
<p>Los contrastes se plantean habitualmente desde el punto de vista de la inferencia estadística en la práctica: se realiza una prueba sobre la única muestra disponible. Si se realiza una única prueba, en las condiciones de <span class="math inline">\(H_{0}\)</span> hay una probabilidad <span class="math inline">\(\alpha\)</span> de rechazarla. En simulación tiene mucho más sentido realizar un gran número de pruebas:</p>
<ul>
<li><p>La proporción de rechazos debería aproximarse al valor de <span class="math inline">\(\alpha\)</span>(se puede comprobar para distintos valores de <span class="math inline">\(\alpha\)</span>).</p></li>
<li><p>La distribución del estadístico debería ajustarse a la teórica bajo <span class="math inline">\(H_{0}\)</span>(se podría realizar un nuevo contraste de bondad de ajuste).</p></li>
<li><p>Los <em>p</em>-valores obtenidos deberían ajustarse a una <span class="math inline">\(\mathcal{U}\left(0,1\right)\)</span> (se podría realizar también un contraste de bondad de ajuste).</p></li>
</ul>
<p>Este procedimiento es también el habitual para validar un método de contraste de hipótesis por simulación.</p>

<div class="example">
<span id="exm:unnamed-chunk-21" class="example"><strong>Ejemplo 3.1  </strong></span>
</div>
<p></p>
<p>Consideramos el generador congruencial RANDU:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Valores iniciales</span>
<span class="kw">initRANDC</span>(<span class="dv">543210</span>)   <span class="co"># Fijar semilla para reproductibilidad</span>
<span class="co"># set.seed(543210)</span>
n &lt;-<span class="st"> </span><span class="dv">500</span>
nsim &lt;-<span class="st"> </span><span class="dv">1000</span>
estadistico &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)
pvalor &lt;-<span class="st"> </span><span class="kw">numeric</span>(nsim)

<span class="co"># Realizar contrastes</span>
for(isim in <span class="dv">1</span>:nsim) {
  u &lt;-<span class="st"> </span><span class="kw">RANDCN</span>(n)    <span class="co"># Generar</span>
  <span class="co"># u &lt;- runif(n)</span>
  tmp &lt;-<span class="st"> </span><span class="kw">chisq.test.cont</span>(u, <span class="dt">distribution=</span><span class="st">&quot;unif&quot;</span>, 
                        <span class="dt">nclasses=</span><span class="dv">100</span>, <span class="dt">output=</span><span class="ot">FALSE</span>, <span class="dt">nestpar=</span><span class="dv">0</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)
  estadistico[isim] &lt;-<span class="st"> </span>tmp$statistic
  pvalor[isim] &lt;-<span class="st"> </span>tmp$p.value
}</code></pre></div>
<p>Proporción de rechazos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cat(&quot;\nProporción de rechazos al 1% =&quot;, sum(pvalor &lt; 0.01)/nsim, &quot;\n&quot;)</span>
<span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Proporción de rechazos al 1% =&quot;</span>, <span class="kw">mean</span>(pvalor &lt;<span class="st"> </span><span class="fl">0.01</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## 
## Proporción de rechazos al 1% = 0.014</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cat(&quot;Proporción de rechazos al 5% =&quot;, sum(pvalor &lt; 0.05)/nsim, &quot;\n&quot;)</span>
<span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 5% =&quot;</span>, <span class="kw">mean</span>(pvalor &lt;<span class="st"> </span><span class="fl">0.05</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## Proporción de rechazos al 5% = 0.051</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cat(&quot;Proporción de rechazos al 10% =&quot;, sum(pvalor &lt; 0.1)/nsim, &quot;\n&quot;)</span>
<span class="kw">cat</span>(<span class="st">&quot;Proporción de rechazos al 10% =&quot;</span>, <span class="kw">mean</span>(pvalor &lt;<span class="st"> </span><span class="fl">0.1</span>), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## Proporción de rechazos al 10% = 0.112</code></pre>
<p>Análisis del estadístico contraste:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma</span>
<span class="kw">hist</span>(estadistico, <span class="dt">breaks =</span> <span class="st">&quot;FD&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">curve</span>(<span class="kw">dchisq</span>(x,<span class="dv">99</span>), <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test ji-cuadrado</span>
<span class="co"># chisq.test.cont(estadistico, distribution=&quot;chisq&quot;, nclasses=20, nestpar=0, df=99)</span>
<span class="co"># Test de Kolmogorov-Smirnov</span>
<span class="kw">ks.test</span>(estadistico, <span class="st">&quot;pchisq&quot;</span>, <span class="dt">df=</span><span class="dv">99</span>)</code></pre></div>
<pre><code>## Warning in ks.test(estadistico, &quot;pchisq&quot;, df = 99): ties should not be
## present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  estadistico
## D = 0.023499, p-value = 0.6388
## alternative hypothesis: two-sided</code></pre>
<p>Análisis de los p-valores:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Histograma</span>
<span class="kw">hist</span>(pvalor, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">1</span>) <span class="co"># curve(dunif(x,0,1), add=TRUE)</span></code></pre></div>
<p><img src="03-Generacion_numeros_aleatorios_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test ji-cuadrado</span>
<span class="co"># chisq.test.cont(pvalor, distribution=&quot;unif&quot;, nclasses=20, nestpar=0, min=0, max=1)</span>
<span class="co"># Test de Kolmogorov-Smirnov</span>
<span class="kw">ks.test</span>(pvalor, <span class="st">&quot;punif&quot;</span>,  <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## Warning in ks.test(pvalor, &quot;punif&quot;, min = 0, max = 1): ties should not be
## present for the Kolmogorov-Smirnov test</code></pre>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  pvalor
## D = 0.023499, p-value = 0.6388
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="baterias-de-contrastes" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Baterías de contrastes</h3>
<p>Contrastes específicos para generadores aleatorios:</p>
<ul>
<li><p>Diehard tests (The Marsaglia Random Number CDROM): <a href="http://www.stat.fsu.edu/pub/diehard" class="uri">http://www.stat.fsu.edu/pub/diehard</a>.</p></li>
<li><p>TestU01: <a href="http://www.iro.umontreal.ca/simardr/testu01/tu01.html" class="uri">http://www.iro.umontreal.ca/simardr/testu01/tu01.html</a>.</p></li>
<li><p>NIST test suite: <a href="http://csrc.nist.gov/groups/ST/toolkit/rng" class="uri">http://csrc.nist.gov/groups/ST/toolkit/rng</a>.</p></li>
<li><p>Dieharder (paquete <code>RDieHarder</code>): <a href="http://www.phy.duke.edu/rgb/General/dieharder.php" class="uri">http://www.phy.duke.edu/rgb/General/dieharder.php</a></p></li>
<li><p>Entidad Certificadora (gratuita): <a href="http://www.cacert.at/random">CAcert</a>.</p></li>
</ul>
<p>Documentación adicional:</p>
<ul>
<li><p>Randomness Tests: A Literature Survey <a href="http://www.ciphersbyritter.com/RES/RANDTEST.HTM" class="uri">http://www.ciphersbyritter.com/RES/RANDTEST.HTM</a>-</p></li>
<li><p>Marsaglia, Tsang (2002). Some Difficult-to-pass Tests of Randomness: <a href="http://www.jstatsoft.org/v07/i03" class="uri">http://www.jstatsoft.org/v07/i03</a><br />
<a href="http://www.csis.hku.hk/cisc/download/idetect" class="uri">http://www.csis.hku.hk/cisc/download/idetect</a></p></li>
</ul>
</div>
</div>
<div id="ejercicios-de-fin-de-practica" class="section level2">
<h2><span class="header-section-number">3.3</span> Ejercicios de fin de práctica</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-26" class="exercise"><strong>Ejercicio 3.1  </strong></span>
</div>
<p> Uno de los primeros generadores fue el denominado método de los cuadrados medios propuesto por Von Neumann (1946). Con este procedimiento se generan números pseudoaleatorios de 4 dígitos de la siguiente forma:</p>
<ol style="list-style-type: lower-roman">
<li><p>Se escoge un número de cuatro dígitos <span class="math inline">\(x_{0}\)</span> (semilla).</p></li>
<li><p>Se eleva al cuadrado (<span class="math inline">\(x_{0}^{2}\)</span>) y se toman los cuatro dígitos centrales (<span class="math inline">\(x_{1}\)</span>).</p></li>
<li><p>Se genera el número pseudo-aleatorio como<span class="math display">\[u_{1}=\frac{x_{1}}{10^{4}}.\]</span></p></li>
<li><p>Volver al paso ii y repetir el proceso.</p></li>
</ol>
<p>Para obtener los <span class="math inline">\(k\)</span> (número par) dígitos centrales de <span class="math inline">\(x_{i}^{2}\)</span> se puede utilizar que: <span class="math display">\[x_{i+1}=\left\lfloor \left(  x_{i}^{2}-\left\lfloor \dfrac{x_{i}^{2}}{10^{(2k-\frac{k}{2})}}\right\rfloor 10^{(2k-\frac{k}{2})}\right)
/10^{\frac{k}{2}}\right\rfloor\]</span></p>
<p>El algoritmo está implementado en el fichero <em>RANDVN.R</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generador Von Neumann de números pseudoaleatorios</span>
<span class="co"># =================================================</span>

<span class="co"># -------------------------------------------------</span>
<span class="co"># initRANDVN(semilla,n)</span>
<span class="co">#   Inicia el generador </span>
<span class="co">#   n número de digitos centrales, 4 por defecto (debe ser un nº par)</span>
<span class="co">#   Por defecto semilla del reloj</span>
<span class="co">#   OJO: No se hace ninguna verificación de los parámetros</span>
initRANDVN &lt;-<span class="st"> </span>function(<span class="dt">semilla =</span> <span class="kw">as.numeric</span>(<span class="kw">Sys.time</span>()), <span class="dt">n =</span> <span class="dv">4</span>) {
  .semilla &lt;&lt;-<span class="st"> </span><span class="kw">as.double</span>(semilla) %%<span class="st"> </span><span class="dv">10</span>^n  <span class="co"># Cálculos en doble precisión</span>
  .n &lt;&lt;-<span class="st"> </span>n
  .aux &lt;&lt;-<span class="st"> </span><span class="dv">10</span>^(<span class="dv">2</span>*n-n/<span class="dv">2</span>)
  .aux2 &lt;&lt;-<span class="st"> </span><span class="dv">10</span>^(n/<span class="dv">2</span>)
  <span class="kw">return</span>(<span class="kw">invisible</span>(<span class="kw">list</span>(<span class="dt">semilla=</span>.semilla,<span class="dt">n=</span>.n)))
}

<span class="co"># -------------------------------------------------</span>
<span class="co"># RANDVN()</span>
<span class="co">#   Genera un valor pseudoaleatorio con el generador de Von Neumann</span>
<span class="co">#   Actualiza la semilla (si no existe llama a initRANDVN)</span>
RANDVN &lt;-<span class="st"> </span>function() {
    if (!<span class="kw">exists</span>(<span class="st">&quot;.semilla&quot;</span>, <span class="dt">envir=</span><span class="kw">globalenv</span>())) <span class="kw">initRANDVN</span>()
    z &lt;-<span class="st"> </span>.semilla^<span class="dv">2</span>
    .semilla &lt;&lt;-<span class="st"> </span><span class="kw">trunc</span>((z-<span class="kw">trunc</span>(z/.aux)*.aux)/.aux2)
    <span class="kw">return</span>(.semilla/<span class="dv">10</span>^.n)
}

<span class="co"># -------------------------------------------------</span>
<span class="co"># RANDVNN(n)</span>
<span class="co">#   Genera un vector de valores pseudoaleatorios con el generador congruencial</span>
<span class="co">#   (por defecto de dimensión 1000)</span>
<span class="co">#   Actualiza la semilla (si no existe llama a initRANDVN)</span>
RANDVNN &lt;-<span class="st"> </span>function(<span class="dt">n =</span> <span class="dv">1000</span>) {
    x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
    for(i in <span class="dv">1</span>:n) x[i] &lt;-<span class="st"> </span><span class="kw">RANDVN</span>()
    <span class="kw">return</span>(x)
    <span class="co"># return(replicate(n,RANDVN()))  # Alternativa más rápida</span>
}</code></pre></div>
<p>Estudiar las características del generador de cuadrados medios a partir de una secuencia de 500 valores. Emplear únicamente métodos gráficos.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-28" class="exercise"><strong>Ejercicio 3.2  </strong></span>
</div>
<p> Considerando el generador congruencial multiplicativo de parámetros <span class="math inline">\(a=7^{5}=16807\)</span>, <span class="math inline">\(c=0\)</span> y <span class="math inline">\(m=2^{31}-1\)</span>. ¿Se observan los mismos problemas que con el algoritmo RANDU al considerar las tripletas <span class="math inline">\((x_{k},x_{k+1},x_{k+2})\)</span>?</p>

<div class="exercise">
<span id="exr:unnamed-chunk-29" class="exercise"><strong>Ejercicio 3.3  </strong></span><strong>(para entregar)</strong>
</div>
<p> Considera el generador congruencial definido por: <span class="math display">\[\begin{aligned}
x_{n+1}  &amp; =(65x_{n}+1)\ \operatorname{mod}\ 2048,\nonumber\\
u_{n+1}  &amp; =\frac{x_{n+1}}{2048},\ n=0,1,\dots\nonumber
\end{aligned}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Indicar razonadamente si es de ciclo máximo.</p></li>
<li><p>Generar 1000 valores tomando como semilla inicial el nº de grupo multiplicado por 100 y obtener el tiempo de CPU. Representar gráficamente el ajuste a la densidad teórica y realizar el correspondiente contraste de Kolmogorov-Smirnov.</p></li>
<li><p>Representar los pares de datos <span class="math inline">\(\left( u_{i}, u_{i+1} \right)\)</span>, ¿se observa algún problema?.</p></li>
<li><p>Estudiar la aleatoriedad de este generador empleando repetidamente el test de Ljung-Box, considerando 500 pruebas con muestras de tamaño 50 y hasta el salto 10 (<code>Box.test(u,lag=10, type=Ljung)</code>). Comparar el ajuste de las distribuciones del estadístico y <span class="math inline">\(p\)</span>-valor a las de referencia.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="numeros-aleatorios-en-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analisis-de-los-resultados.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-Generacion_numeros_aleatorios.Rmd",
"text": "Edit"
},
"download": ["Practicas_de_Simulacion.pdf", "Practicas_de_Simulacion.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
